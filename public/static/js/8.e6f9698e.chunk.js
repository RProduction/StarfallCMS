(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{200:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l});var a=n(221),r=n(222),c=function(e){return e.entities},o=function(e){return Object.values(c(e))},i=function(){return Object(a.a)(o,function(e,t){return t},function(e,t){return e.filter(function(e){return e.projectId===t})})},u=function(){return Object(a.a)(o,function(e,t){return Object(r.b)()(e,t)},function(e,t){return{project:t,entities:e.filter(function(e){return e.projectId===t.id})}})},l=function(){return Object(a.a)(o,function(e,t,n){return Object(r.b)()(e,t)},function(e,t,n){return n},function(e,t,n){return e.find(function(e){return e.name===n&&e.projectId===t.id})})}},201:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(693),o=n(703);t.a=function(e){return r.a.createElement(o.a,Object.assign({minHeight:"100vh",component:c.a,maxWidth:"xl"},e),e.children)}},222:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return o});var a=n(221),r=function(e){return e.projects},c=function(e){return Object.values(r(e))},o=function(){return Object(a.a)(c,function(e,t){return t},function(e,t){return e.find(function(e){return e.name===t})})}},223:function(e,t,n){"use strict";n.d(t,"f",function(){return f}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return b}),n.d(t,"c",function(){return E}),n.d(t,"d",function(){return j});var a=n(16),r=n.n(a),c=n(26),o=n(310),i=n(253),u=n(312),l=n(200),d=n(27),s=n(311);function f(e){return{type:"SET_PROJECT_POPOVER",anchor:e}}var m=function(e){return{type:"ADD_PROJECTS",projects:e}},p=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n,a){var c,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(l.a)(),i=c(a(),e),n(Object(o.b)(i.map(function(e){return e.id}))),n({type:"DELETE_PROJECT",id:e});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},b=function(e,t,n,a){return{type:"RENAME_PROJECT",id:e,name:t,updated:n,publicKey:a}},E=function(e,t,n){return{type:"IMG_PROJECT",id:e,img:t,updated:n}},j=function(){return function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,c,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get("project");case 3:n=e.sent,a=Object(s.b)(n.data),c=[],l=[],a.result.forEach(function(e){c.push({id:a.entities.projects[e].id,name:a.entities.projects[e].name,img:a.entities.projects[e].img_url,created:a.entities.projects[e].created_at,updated:a.entities.projects[e].updated_at,publicKey:a.entities.projects[e].public_key}),t(m(c)),a.entities.projects[e].entities.forEach(function(e){l.push({id:a.entities.entities[e].id,projectId:a.entities.entities[e].project_id,name:a.entities.entities[e].name,created:a.entities.entities[e].created_at,updated:a.entities.entities[e].updated_at})})}),t(Object(o.a)(l)),l.forEach(function(e){return t(Object(i.c)(e.id))}),c.forEach(function(e){return t(Object(u.b)(e.id))}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,null,[[0,13]])}));return function(t){return e.apply(this,arguments)}}()}},253:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return s});var a=n(16),r=n.n(a),c=n(26),o=n(311),i=n(27),u=function(e){return{type:"ADD_DOCUMENTS",documents:e}},l=function(e){return{type:"DELETE_DOCUMENTS",documents:e}},d=function(e,t,n){return{type:"MODIFY_DOCUMENT",id:e,updated:t,data:n}},s=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n){var a,c,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.get("document/".concat(e));case 3:a=t.sent,c=Object(o.a)(a.data),l=[],c.result.forEach(function(e){l.push({id:c.entities.documents[e].id,entityId:c.entities.documents[e].entity_id,created:c.entities.documents[e].created_at,updated:c.entities.documents[e].updated_at,data:c.entities.documents[e].data})}),n({type:"SET_DOCUMENT_INIT",entityId:e}),n(u(l)),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}},t,null,[[0,11]])}));return function(e){return t.apply(this,arguments)}}()}},254:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l});var a=n(221),r=n(200),c=function(e){return e.documents},o=function(e,t){return c(e)[t]},i=function(e){return Object.values(c(e))},u=function(){return Object(a.a)(i,function(e,t){return t},function(e,t){return e.filter(function(e){return e.entityId===t})})},l=function(){return Object(a.a)(i,function(e,t,n){return Object(r.c)()(e,t,n)},function(e,t){return{entity:t,documents:e.filter(function(e){return e.entityId===t.id})}})}},295:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(304),o=n(292),i=n(301),u=n(682);function l(e){var t=e.IconComponent;return t?r.a.createElement(u.a,null,r.a.createElement(t,null)):null}t.a=function(e){var t=e.menus;return r.a.createElement(o.a,e,t.map(function(e,t){var n=e.title?e.title:"",a=e.onClick?e.onClick:function(){};return r.a.createElement(i.a,{key:t,onClick:a},r.a.createElement(l,{IconComponent:e.icon}),r.a.createElement(c.a,null,n))}))}},310:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d});var a=n(16),r=n.n(a),c=n(26),o=n(253),i=n(254),u=function(e){return{type:"ADD_ENTITIES",entities:e}},l=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n,a){var c,u;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(i.b)(),u=[],e.forEach(function(e){c(a(),e).forEach(function(e){return u.push(e.id)})}),n(Object(o.b)(u)),n({type:"DELETE_ENTITIES",entities:e});case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},d=function(e,t,n){return{type:"RENAME_ENTITY",id:e,name:t,updated:n}}},311:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return s});var a=n(421),r=new a.b.Entity("documents",{},{idAttribute:"id"}),c=new a.b.Array(r),o=new a.b.Entity("entities",{documents:c},{idAttribute:"id"}),i=new a.b.Array(o),u=new a.b.Entity("projects",{entities:i},{idAttribute:"id"}),l=new a.b.Array(u);function d(e){return Object(a.a)(e,l)}function s(e){return Object(a.a)(e,c)}},312:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"b",function(){return s});var a=n(16),r=n.n(a),c=n(26),o=n(27),i=function(e){return{type:"UPLOAD_STORAGE",files:e}},u=function(e,t,n){return{type:"RENAME_STORAGE",id:e,name:t,updated:n}},l=function(e,t,n){return{type:"PUBLIC_STORAGE",id:e,isPublic:t,updated:n}},d=function(e){return{type:"DELETE_STORAGE",ids:e}},s=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.get("storage/".concat(e));case 3:a=t.sent,n(i(a.data)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()}},705:function(e,t,n){"use strict";n.r(t);var a=n(217),r=n(0),c=n.n(r),o=n(22),i=n(161),u=n.n(i),l=n(33),d=n(58),s=n(304),f=n(688),m=n(307),p=n(308),b=n(398),E=n(703),j=n(415),g=n.n(j),O=n(416),v=n.n(O),h=n(45),y=n(18),_=n(414),k=n.n(_),w=n(413),x=n.n(w),C=n(61),T=n(295);var N=function(e){var t=e.anchor,n=e.close,a=Object(l.c)();return c.a.createElement(T.a,{id:t?"User":null,open:!!t,onClose:function(){return n()},anchorEl:t,menus:[{title:"User List",icon:x.a,onClick:function(){}},{title:"Sign Out",icon:k.a,onClick:function(){return a(Object(C.b)())}}]})},S=n(46);var I=function(e){var t=e.location,n=Object(r.useState)({}),a=Object(d.a)(n,2),i=a[0],u=a[1];Object(r.useEffect)(function(){var e=(t.pathname.match(/\/./g)||[]).length;0===e?u({}):1===e?u(Object(o.f)(t.pathname,{path:"/:project",exact:!0}).params):2===e?u(Object(o.f)(t.pathname,{path:"/:project/:entity",exact:!0}).params):3===e&&u(Object(o.f)(t.pathname,{path:"/:project/:entity/:document",exact:!0}).params)},[t.pathname]);var l=i.project,s=i.entity,f=i.document;return c.a.createElement(c.a.Fragment,null,c.a.createElement(S.b,{to:"/"}," StarfallCMS "),l?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(S.b,{to:"/".concat(l)}," ",l," ")):null,s?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(S.b,{to:"/".concat(l,"/").concat(s)}," ",s," ")):null,f?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(S.b,{to:"/".concat(l,"/").concat(s,"/").concat(f)}," ",f," ")):null)},P=u()(function(e){return{root:Object(a.a)({backgroundColor:e.palette.primary.light},e.responsive),link:{"& a":{color:"black",paddingLeft:e.spacing(.35),paddingRight:e.spacing(.35),fontSize:"115%"},whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},hide:e.hide}});var A=function(e){var t=P(),n=Object(l.c)(),a=Object(l.d)(function(e){return e.sidebar}),o=Object(r.useState)(null),i=Object(d.a)(o,2),u=i[0],j=i[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(f.a,{position:"fixed",className:t.root},c.a.createElement(m.a,null,c.a.createElement(b.a,{mdUp:!0},c.a.createElement(p.a,{color:"inherit","aria-label":"Open drawer",onClick:function(){return n(Object(y.l)(!a))},edge:"start",className:Object(h.a)(a&&t.hide)},c.a.createElement(g.a,null))),c.a.createElement(E.a,{display:"flex",flexGrow:1,container:s.a,variant:"h6",align:"center",className:t.link},c.a.createElement(I,e)),c.a.createElement(p.a,{edge:"end","aria-label":"Account of current user","aria-haspopup":"true",color:"inherit",onClick:function(e){return j(e.currentTarget)}},c.a.createElement(v.a,null)))),c.a.createElement(N,{anchor:u,close:function(){return j(null)}}))},D=u()(function(e){return{root:Object(a.a)({backgroundColor:"#292D2E"},e.responsive),text:{color:"white",fontSize:"125%",textAlign:"center",lineHeight:"50px"}}});var R=function(){var e=D();return c.a.createElement("footer",{className:e.root},c.a.createElement(s.a,{variant:"h3",className:e.text},"Copyright Starfall Production"))},M=n(712),F=n(692),U=n(419),L=n.n(U),G=n(420),z=n.n(G),J=n(686),K=n(687),B=n(309),H=n(708),Y=n(689),V=n(417),W=n.n(V),q=n(418),Q=n.n(q),X=u()({root:{flexGrow:1}});var Z=function(e){var t=X(),n=e.name,a=e.projectName;return c.a.createElement(c.a.Fragment,null,c.a.createElement(K.a,{divider:!0},c.a.createElement(H.a,{component:S.b,to:"/".concat(a,"/").concat(n),className:t.root},c.a.createElement(B.a,{primary:n}))))},$=n(200),ee=u()(function(e){return{root:{paddingLeft:e.spacing(1)},hide:{display:"none"},btn:{flexGrow:1}}});var te=function(e){var t=ee(),n=e.id,a=e.name,o=Object(r.useMemo)($.a,[]),i=Object(l.d)(function(e){return o(e,n)}),u=Object(r.useState)(!1),s=Object(d.a)(u,2),f=s[0],m=s[1],b=Object(r.useState)(!1),E=Object(d.a)(b,2),j=E[0],g=E[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(K.a,{button:!0,divider:!0,onClick:function(){return m(!f)}},c.a.createElement(B.a,{primary:a}),f?c.a.createElement(W.a,null):c.a.createElement(Q.a,null)),c.a.createElement(Y.a,{in:f,timeout:"auto",unmountOnExit:!0},c.a.createElement(J.a,{className:t.root,disablePadding:!0},c.a.createElement(K.a,{button:!0,component:S.b,to:"/".concat(a,"/storage"),divider:!0},c.a.createElement(B.a,{primary:"Storage"})),c.a.createElement(K.a,{divider:!0},c.a.createElement(H.a,{component:S.b,to:"/".concat(a),className:t.btn},c.a.createElement(B.a,{primary:"Entities"})),c.a.createElement(p.a,{color:"inherit","aria-label":"Expand ".concat(a," entities"),onClick:function(){return g(!j)},edge:"end",className:Object(h.a)(0===i.length&&t.hide)},j?c.a.createElement(W.a,null):c.a.createElement(Q.a,null))),i.length>0?c.a.createElement(Y.a,{in:j,timeout:"auto",unmountOnExit:!0},c.a.createElement(J.a,{className:t.root,disablePadding:!0},i.map(function(e){return c.a.createElement(Z,{key:e.id,name:e.name,projectName:a})}))):null)))},ne=n(222);var ae=function(e){var t=Object(l.d)(ne.a);return c.a.createElement(J.a,null,c.a.createElement(K.a,{button:!0,component:S.b,to:"/",divider:!0},c.a.createElement(B.a,{primary:"Overview"})),t.map(function(e){return c.a.createElement(te,{id:e.id,name:e.name,key:e.id})}))},re=u()(function(e){return{root:e.sidebar,paper:Object(a.a)({backgroundColor:e.palette.primary.main},e.sidebarPaper),direction:e.direction,btn:Object(a.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar,{justifyContent:"flex-end"})}});var ce=function(e){var t=re(),n=Object(l.c)(),a=Object(l.d)(function(e){return e.sidebar});return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,{mdUp:!0},c.a.createElement(M.a,{className:t.root,variant:"temporary",anchor:"rtl"===t.direction?"right":"left",open:a,classes:{paper:t.paper},ModalProps:{keepMounted:!0}},c.a.createElement("div",{className:t.btn},c.a.createElement(p.a,{onClick:function(){return n(Object(y.l)(!a))}},"ltr"===t.direction?c.a.createElement(L.a,null):c.a.createElement(z.a,null))),c.a.createElement(F.a,null),c.a.createElement(ae,null))),c.a.createElement(b.a,{smDown:!0},c.a.createElement(M.a,{className:t.root,classes:{paper:t.paper},variant:"permanent",open:!0},c.a.createElement(ae,null))))},oe=n(223),ie=n(201),ue=n(422),le=n.n(ue),de=n(310),se=n(253),fe=n(312);var me=function(e){var t=Object(l.c)();return Object(r.useEffect)(function(){var e=le()(null,{path:"starfall-cms-ws"});return e.on("open",function(){var n=e.subscribe("project"),a=e.subscribe("entity"),r=e.subscribe("document"),c=e.subscribe("storage");n.on("add",function(e){console.log("add project"),console.log(e),t(Object(oe.a)([{id:e.id,name:e.name,img:e.img_url,created:e.created_at,updated:e.updated_at,publicKey:e.public_key}]))}),n.on("delete",function(e){console.log("delete project"),console.log(e),t(Object(oe.b)(e.id))}),n.on("rename",function(e){console.log("rename project"),console.log(e),t(Object(oe.e)(e.id,e.name,e.updated_at,e.public_key))}),n.on("img",function(e){console.log("change image of project"),console.log(e),t(Object(oe.c)(e.id,e.img_url,e.updated_at))}),n.on("error",function(e){console.log(e)}),a.on("add",function(e){console.log("add entity"),console.log(e),t(Object(de.a)([{id:e.id,projectId:e.project_id,name:e.name,created:e.created_at,updated:e.updated_at}]))}),a.on("delete",function(e){console.log("delete entity"),console.log(e),t(Object(de.b)([e.id]))}),a.on("rename",function(e){console.log("rename entity"),console.log(e),t(Object(de.c)(e.id,e.name,e.updated_at))}),a.on("error",function(e){console.log(e)}),r.on("add",function(e){console.log("add document"),console.log(e),t(Object(se.a)([{id:e.id,entityId:e.entity_id,created:e.created_at,updated:e.updated_at,data:e.data}]))}),r.on("modify",function(e){console.log("modify document"),console.log(e),t(Object(se.d)(e.id,e.updated_at,e.data))}),r.on("delete",function(e){console.log("delete documents"),console.log(e),t(Object(se.b)(e.ids))}),c.on("upload",function(e){console.log("upload into storage"),console.log(e),t(Object(fe.e)(e))}),c.on("rename",function(e){console.log("rename storage"),console.log(e),t(Object(fe.d)(e.id,e.name,e.updated_at))}),c.on("public",function(e){console.log("toggle isPublic storage"),console.log(e),t(Object(fe.c)(e.id,e.isPublic,e.updated_at))}),c.on("delete",function(e){console.log("delete storage"),console.log(e),t(Object(fe.a)(e.ids))})}),e.on("close",function(){}),e.on("error",function(e){console.log(e)}),e.connect(),function(){e.close()}},[]),null},pe=Object(r.lazy)(function(){return n.e(16).then(n.bind(null,706))}),be=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(12)]).then(n.bind(null,711))}),Ee=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(15)]).then(n.bind(null,700))}),je=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(14)]).then(n.bind(null,701))}),ge=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(13)]).then(n.bind(null,704))}),Oe=u()(function(e){return{root:Object(a.a)({marginTop:65,paddingTop:15,paddingBottom:15,backgroundColor:e.palette.background.light.light,overflow:"auto"},e.responsive)}});t.default=function(e){var t=Oe(),n=Object(l.c)(),a=Object(l.d)(function(e){return e.authStatus});return Object(r.useEffect)(function(){n(Object(oe.d)())},[]),a===C.f?c.a.createElement(o.a,{to:"/signup"}):a===C.g?c.a.createElement(o.a,{to:"/signin"}):c.a.createElement(c.a.Fragment,null,c.a.createElement(A,e),c.a.createElement(ce,null),c.a.createElement(me,null),c.a.createElement(ie.a,{className:t.root},c.a.createElement(r.Suspense,{fallback:c.a.createElement("div",null)},c.a.createElement(o.d,null,c.a.createElement(o.b,{path:"/:project/:entity/:document",component:je}),c.a.createElement(o.b,{path:"/:project/storage",component:ge}),c.a.createElement(o.b,{path:"/:project/:entity",component:Ee}),c.a.createElement(o.b,{path:"/:project",component:be}),c.a.createElement(o.b,{path:"/",component:pe})))),c.a.createElement(R,null))}}}]);
//# sourceMappingURL=8.e6f9698e.chunk.js.map