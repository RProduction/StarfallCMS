(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{158:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(168),c=n(163),i=n(694),l=n(695),s=n(696),u=n(697),m=n(396),d=n(352),f=n(235);var p=function(e){var t=e.request,n=e.btn,a=e.category,o=e.values,c=o.name,i=o.newName,l=o.confirmName,s=e.errors,u=e.touched,p=e.handleChange,b=e.isValid,h=e.setFieldTouched,g=function(e,t){t.persist(),p(t),h(e,!0,!1)};return r.a.createElement(f.a,{container:!0,component:"form",spacing:1,onSubmit:function(e){e.preventDefault(),t({name:c,newName:i,confirmName:l})}},"add"===a?r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"name",name:"name",label:"Name",onChange:g.bind(null,"name"),value:c,helperText:u.name?s.name:"",error:u.name&&Boolean(s.name)}):"delete"===a?r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:g.bind(null,"confirmName"),value:l,helperText:u.confirmName?s.confirmName:"",error:u.confirmName&&Boolean(s.confirmName)}):"rename"===a?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"newName",name:"newName",label:"New Name",onChange:g.bind(null,"newName"),value:i,helperText:u.newName?s.newName:"",error:u.newName&&Boolean(s.newName)}),r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:g.bind(null,"confirmName"),value:l,helperText:u.confirmName?s.confirmName:"",error:u.confirmName&&Boolean(s.confirmName)})):null,r.a.createElement(f.a,{item:!0,xs:12,component:d.a,type:"submit",disabled:!b,size:"large"},n))},b=c.object({name:c.string().required("enter name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"name too short").max(50,"name too long")}),h=c.object({name:c.string(),confirmName:c.string().required("re-enter name").matches(/^[a-z0-9_]*$/i,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).oneOf([c.ref("name")],"Confirm Name does not match")}),g=c.object({name:c.string(),confirmName:c.string().required("re-enter name").oneOf([c.ref("name")],"Confirm Name does not match"),newName:c.string().required("enter new name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"new name too short").max(50,"new name too long")}),v={name:""},y=function(e){return{name:e,confirmName:""}},j=function(e){return{name:e,confirmName:"",newName:""}};t.a=function(e){var t=e.title,n=e.content,a=e.targetName,c=e.category,m=e.dialogProps;return r.a.createElement(i.a,m,r.a.createElement(l.a,{id:"dialog-title"},t),r.a.createElement(s.a,null,"add"===c||"delete"===c||"rename"===c?r.a.createElement(r.a.Fragment,null,"delete"===c?r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,n),r.a.createElement(u.a,null,"Please type in the name of the target to confirm")):null,r.a.createElement(o.a,{validationSchema:"add"===c?b:"rename"===c?g:"delete"===c?h:{},initialValues:"add"===c?v:"rename"===c?j(a):"delete"===c?y(a):{},render:function(t){return r.a.createElement(p,Object.assign({},e,t))}})):"notification"===c?r.a.createElement(u.a,null,n):null))}},215:function(e,t,n){"use strict";var a=n(139);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(141)).default)(r.default.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Create");t.default=o},630:function(e,t,n){"use strict";var a=n(139);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(141)).default)(r.default.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload");t.default=o},703:function(e,t,n){"use strict";n.r(t);var a=n(13),r=n.n(a),o=n(25),c=n(0),i=n.n(c),l=n(22),s=n(247),u=n.n(s),m=n(248),d=n.n(m),f=n(251),p=n.n(f),b=n(250),h=n.n(b),g=n(249),v=n.n(g),y=n(252),j=n.n(y),O=n(199),E=n.n(O),k=n(630),w=n.n(k),N=n(215),x=n.n(N),C=n(237),P=n.n(C),$=n(33),R=n(26),S=n(306),z=n(307),F=n(355);function _(e,t){return!t||"object"!==Object(F.a)(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=n(34),T=n.n(M),B=(n(5),n(147));var A=function(e){function t(){return Object(S.a)(this,t),_(this,D(t).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,i.a.Component),Object(z.a)(t,[{key:"componentDidMount",value:function(){this.ref=T.a.findDOMNode(this),Object(B.b)(this.props.rootRef,this.ref)}},{key:"componentDidUpdate",value:function(e){var t=T.a.findDOMNode(this);e.rootRef===this.props.rootRef&&this.ref===t||(e.rootRef!==this.props.rootRef&&Object(B.b)(e.rootRef,null),this.ref=t,Object(B.b)(this.props.rootRef,this.ref))}},{key:"componentWillUnmount",value:function(){this.ref=null,Object(B.b)(this.props.rootRef,null)}},{key:"render",value:function(){return this.props.children}}]),t}(),I=n(362),q=n.n(I);var U=function(e){var t=Object(c.useRef)(null),n=function(e){console.log("drop mtablebody"),console.log(e.dataTransfer.files),e.preventDefault()},a=function(e){console.log("drag start mtablebody"),e.preventDefault()},r=function(e){console.log("drag end mtablebody"),e.preventDefault()},o=function(e){console.log("drag over mtablebody"),e.preventDefault()},l=function(){return console.log("click")};return Object(c.useEffect)(function(){return t.current.addEventListener("drop",n),t.current.addEventListener("dragstart",a),t.current.addEventListener("dragend",r),t.current.addEventListener("dragover",o),t.current.addEventListener("click",l),function(){t.current.removeEventListener("drop",n),t.current.removeEventListener("dragstart",a),t.current.removeEventListener("dragend",r),t.current.removeEventListener("dragover",o),t.current.removeEventListener("click",l)}},[]),i.a.createElement(A,{rootRef:t},i.a.createElement(q.a,e))},V=n(702),J=n(304),Z=n(6),H=n(16),W=n(45),X=n(138),G=n(35),K=n(142),Q=n(363),Y=i.a.forwardRef(function(e,t){var n=e.classes,a=e.className,r=e.color,o=void 0===r?"secondary":r,c=e.edge,l=void 0!==c&&c,s=e.size,u=void 0===s?"medium":s,m=Object(H.a)(e,["classes","className","color","edge","size"]),d=i.a.createElement("span",{className:n.thumb});return i.a.createElement("span",{className:Object(W.a)(n.root,a,{start:n.edgeStart,end:n.edgeEnd}[l],{small:n["size".concat(Object(K.a)(u))]}[u])},i.a.createElement(Q.a,Object(Z.a)({type:"checkbox",icon:d,checkedIcon:d,classes:{root:Object(W.a)(n.switchBase,n["color".concat(Object(K.a)(o))]),input:n.input,checked:n.checked,disabled:n.disabled},ref:t},m)),i.a.createElement("span",{className:n.track}))}),ee=Object(X.a)(function(e){return{root:{display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle"},edgeStart:{marginLeft:-8},edgeEnd:{marginRight:-8},switchBase:{position:"absolute",top:0,left:0,zIndex:1,color:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[400],transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),willChange:"left, transform","&$checked":{left:"100%",transform:"translateX(-100%)"},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{opacity:.5},"&$disabled + $track":{opacity:"light"===e.palette.type?.12:.1}},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(G.c)(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.primary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(G.c)(e.palette.secondary.main,e.palette.action.hoverOpacity)}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.secondary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},sizeSmall:{width:40,height:24,padding:7,"& $thumb":{width:16,height:16},"& $switchBase":{padding:4}},checked:{},disabled:{},input:{left:"-100%",width:"300%"},thumb:{boxShadow:e.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},track:{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.type?.38:.3}}},{name:"MuiSwitch"})(Y),te=n(18);var ne=function(e){var t=e.rowData,n=Object($.c)();return i.a.createElement(V.a,{display:"flex",alignItems:"center"},i.a.createElement(ee,{checked:t.isPublic,onChange:function(){var e=Object(o.a)(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.post("storage/".concat(t.id,"/public"));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),n(Object(te.j)("Toggle File Access","Fail toggling file access, error: ".concat(e.t0)));case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(J.a,null,t.isPublic?"Public":"Private"))},ae=n(220),re=n(221),oe=function(e){return e.storage},ce=function(){return Object(ae.a)(oe,function(e,t){return Object(re.b)()(e,t)},function(e,t){return t?{project:t,storage:Object.values(e).filter(function(e){return e.project_id===t.id})}:null})},ie=n(158);var le=function(e){var t=Object($.c)(),n=Object($.d)(function(e){return e.target}),a=Object($.d)(function(e){return e.dialog}),c=Object($.d)(function(e){return e.notification});return i.a.createElement(i.a.Fragment,null,i.a.createElement(ie.a,{dialogProps:{open:a===te.f,onClose:function(){return t(Object(te.c)())}},category:"add",title:'Rename "'.concat(n.name,'"'),btn:"Rename ".concat(n.name),request:function(){var e=Object(o.a)(r.a.mark(function e(a){var o,c,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.name,c=n.name.split(".")[1],i=c?"".concat(o,".").concat(c):o,e.prev=3,e.next=6,R.a.post("storage/".concat(n.id,"/rename"),{name:i});case 6:t(Object(te.c)()),t(Object(te.j)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Succeed renaming "'.concat(n.name,'" into "').concat(i,'"'))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),t(Object(te.c)()),t(Object(te.j)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Fail renaming "'.concat(n.name,'" into "').concat(i,", error: ").concat(e.t0,'"')));case 14:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(ie.a,{category:"notification",title:c.title,content:c.content,dialogProps:{open:""!==c.title&&""!==c.content,onClose:function(){return t(Object(te.d)())}}}))},se=[{title:"#",field:"#",searchable:!1},{field:"id",searchable:!1,hidden:!0},{title:"Name",field:"name",searchable:!0},{title:"Size",field:"size",searchable:!1},{title:"Created At",field:"created",searchable:!1},{title:"Modified At",field:"modified",searchable:!1},{title:"Is Public?",field:"isPublic",render:function(e){return i.a.createElement(ne,{rowData:e})}}];t.default=function(e){var t=Object($.c)(),n=e.match.params.project,a=Object(c.useRef)(null),s=Object(c.useMemo)(ce,[]),m=Object($.d)(function(e){return s(e,n)});return console.log(m),m?i.a.createElement(i.a.Fragment,null,i.a.createElement(le,null),i.a.createElement(P.a,{title:"Storage",columns:se,data:m.storage.map(function(e,t){return{"#":t+1,id:e.id,name:e.name,size:e.size,created:e.created,modified:e.modified,isPublic:e.isPublic}}),actions:[{icon:function(){return i.a.createElement(w.a,null)},tooltip:"Upload Files",isFreeAction:!0,onClick:function(){return a.current.click()}},function(e){return{icon:function(){return i.a.createElement(x.a,null)},tooltip:"Rename",onClick:function(e,n){t(Object(te.g)({id:n[0].id,name:n[0].name})),t(Object(te.k)())},hidden:1!==e.length}},{icon:function(){return i.a.createElement(E.a,null)},tooltip:"Delete",onClick:function(){var e=Object(o.a)(r.a.mark(function e(n,a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.delete("storage",{data:{ids:a.map(function(e){return e.id})}});case 3:t(Object(te.j)("Delete Files","Succeed deleting files")),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t(Object(te.j)("Delete Files","Fail deleting files, error: ".concat(e.t0)));case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,n){return e.apply(this,arguments)}}()}],icons:{Search:u.a,ResetSearch:d.a,FirstPage:v.a,PreviousPage:h.a,NextPage:p.a,LastPage:j.a},components:{Body:U},options:{search:!1,selection:!0,paging:!1,draggable:!1,actionsColumnIndex:-1}}),i.a.createElement("input",{multiple:!0,name:"files",type:"file",style:{display:"none"},ref:a,onChange:function(){var e=Object(o.a)(r.a.mark(function e(n){var o,c,i,l,s,u,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log(a.current.files),e.prev=1,o=new FormData,c=!0,i=!1,l=void 0,e.prev=6,s=a.current.files[Symbol.iterator]();!(c=(u=s.next()).done);c=!0)d=u.value,o.append("file[]",d,d.name);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),i=!0,l=e.t0;case 14:e.prev=14,e.prev=15,c||null==s.return||s.return();case 17:if(e.prev=17,!i){e.next=20;break}throw l;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return e.next=24,R.a.post("storage/".concat(m.project.id),o,{headers:{"Content-Type":"multipart/form-data"}});case 24:t(Object(te.j)("Upload Files","Succeed uploading files")),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(1),t(Object(te.j)("Upload Files","Fail uploading files, error: ".concat(e.t1)));case 30:case"end":return e.stop()}},e,null,[[1,27],[6,10,14,22],[15,,17,21]])}));return function(t){return e.apply(this,arguments)}}()})):i.a.createElement(l.a,{to:"/"})}}}]);
//# sourceMappingURL=13.931688b0.chunk.js.map