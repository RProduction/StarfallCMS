(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{166:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(175),o=n(172),i=n(704),l=n(705),u=n(706),m=n(707),s=n(403),d=n(360),f=n(243);var p=function(e){var t=e.request,n=e.btn,a=e.category,c=e.values,o=c.name,i=c.newName,l=c.confirmName,u=e.errors,m=e.touched,p=e.handleChange,h=e.isValid,v=e.setFieldTouched,b=function(e,t){t.persist(),p(t),v(e,!0,!1)};return r.a.createElement(f.a,{container:!0,component:"form",spacing:1,onSubmit:function(e){e.preventDefault(),t({name:o,newName:i,confirmName:l})}},"add"===a?r.a.createElement(f.a,{component:s.a,item:!0,xs:12,id:"name",name:"name",label:"Name",onChange:b.bind(null,"name"),value:o,helperText:m.name?u.name:"",error:m.name&&Boolean(u.name)}):"delete"===a?r.a.createElement(f.a,{component:s.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:b.bind(null,"confirmName"),value:l,helperText:m.confirmName?u.confirmName:"",error:m.confirmName&&Boolean(u.confirmName)}):"rename"===a?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{component:s.a,item:!0,xs:12,id:"newName",name:"newName",label:"New Name",onChange:b.bind(null,"newName"),value:i,helperText:m.newName?u.newName:"",error:m.newName&&Boolean(u.newName)}),r.a.createElement(f.a,{component:s.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:b.bind(null,"confirmName"),value:l,helperText:m.confirmName?u.confirmName:"",error:m.confirmName&&Boolean(u.confirmName)})):null,r.a.createElement(f.a,{item:!0,xs:12,component:d.a,type:"submit",disabled:!h,size:"large"},n))},h=o.object({name:o.string().required("enter name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"name too short").max(50,"name too long")}),v=o.object({name:o.string(),confirmName:o.string().required("re-enter name").matches(/^[a-z0-9_]*$/i,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).oneOf([o.ref("name")],"Confirm Name does not match")}),b=o.object({name:o.string(),confirmName:o.string().required("re-enter name").oneOf([o.ref("name")],"Confirm Name does not match"),newName:o.string().required("enter new name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"new name too short").max(50,"new name too long")}),g={name:""},j=function(e){return{name:e,confirmName:""}},O=function(e){return{name:e,confirmName:"",newName:""}};t.a=function(e){var t=e.title,n=e.content,a=e.targetName,o=e.category,s=e.dialogProps;return r.a.createElement(i.a,s,r.a.createElement(l.a,{id:"dialog-title"},t),r.a.createElement(u.a,null,"add"===o||"delete"===o||"rename"===o?r.a.createElement(r.a.Fragment,null,"delete"===o?r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null,n),r.a.createElement(m.a,null,"Please type in the name of the target to confirm")):null,r.a.createElement(c.a,{validationSchema:"add"===o?h:"rename"===o?b:"delete"===o?v:{},initialValues:"add"===o?g:"rename"===o?O(a):"delete"===o?j(a):{},render:function(t){return r.a.createElement(p,Object.assign({},e,t))}})):"notification"===o?r.a.createElement(m.a,null,n):null))}},218:function(e,t,n){"use strict";var a=n(144);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(146)).default)(r.default.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Create");t.default=c},637:function(e,t,n){"use strict";var a=n(144);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(146)).default)(r.default.createElement("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}),"Folder");t.default=c},638:function(e,t,n){"use strict";var a=n(144);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(146)).default)(r.default.createElement("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"}),"InsertDriveFile");t.default=c},639:function(e,t,n){"use strict";var a=n(144);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(146)).default)(r.default.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload");t.default=c},640:function(e,t,n){"use strict";var a=n(144);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(146)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),r.default.createElement("path",{d:"M20 6h-8l-2-2H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-1 8h-3v3h-2v-3h-3v-2h3V9h2v3h3v2z"})),"CreateNewFolder");t.default=c},641:function(e,t,n){"use strict";var a=n(144);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),c=(0,a(n(146)).default)(r.default.createElement("path",{d:"M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");t.default=c},713:function(e,t,n){"use strict";n.r(t);var a=n(16),r=n.n(a),c=n(26),o=n(0),i=n.n(o),l=n(293),u=n.n(l),m=n(294),s=n.n(m),d=n(296),f=n.n(d),p=n(254),h=n.n(p),v=n(295),b=n.n(v),g=n(297),j=n.n(g),O=n(219),E=n.n(O),w=n(639),N=n.n(w),y=n(640),x=n.n(y),F=n(218),k=n.n(F),C=n(641),_=n.n(C),z=n(285),M=n.n(z),P=n(33),L=n(27),R=n(305),D=n(306),S=n(363);function A(e,t){return!t||"object"!==Object(S.a)(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var T=n(34),q=n.n(T),U=(n(4),n(152));var B=function(e){function t(){return Object(R.a)(this,t),A(this,H(t).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,i.a.Component),Object(D.a)(t,[{key:"componentDidMount",value:function(){this.ref=q.a.findDOMNode(this),Object(U.b)(this.props.rootRef,this.ref)}},{key:"componentDidUpdate",value:function(e){var t=q.a.findDOMNode(this);e.rootRef===this.props.rootRef&&this.ref===t||(e.rootRef!==this.props.rootRef&&Object(U.b)(e.rootRef,null),this.ref=t,Object(U.b)(this.props.rootRef,this.ref))}},{key:"componentWillUnmount",value:function(){this.ref=null,Object(U.b)(this.props.rootRef,null)}},{key:"render",value:function(){return this.props.children}}]),t}(),I=n(370),$=n.n(I);var J=function(e){var t=Object(o.useRef)(null),n=function(e){console.log("drop mtablebody"),console.log(e.dataTransfer.files),e.preventDefault()},a=function(e){console.log("drag start mtablebody"),e.preventDefault()},r=function(e){console.log("drag end mtablebody"),e.preventDefault()},c=function(e){console.log("drag over mtablebody"),e.preventDefault()},l=function(){return console.log("click")};return Object(o.useEffect)(function(){return t.current.addEventListener("drop",n),t.current.addEventListener("dragstart",a),t.current.addEventListener("dragend",r),t.current.addEventListener("dragover",c),t.current.addEventListener("click",l),function(){t.current.removeEventListener("drop",n),t.current.removeEventListener("dragstart",a),t.current.removeEventListener("dragend",r),t.current.removeEventListener("dragover",c),t.current.removeEventListener("click",l)}},[]),i.a.createElement(B,{rootRef:t},i.a.createElement($.a,e))},Z=n(316),W=n(312),G=n(712),K=n(163),Q=n.n(K),X=n(207),Y=Q()(function(e){return{icon:{width:48,height:48,paddingLeft:e.spacing(.5)}}});var ee=function(e){var t=e.title,n=Object(P.c)(),a=Y();return i.a.createElement(G.a,{display:"flex",alignItems:"center"},"/"!==t?i.a.createElement(Z.a,{className:a.icon,onClick:function(){n(Object(X.a)())}},i.a.createElement(h.a,null)):null,i.a.createElement(W.a,null,t))},te=n(371),ne=n.n(te);var ae=function(e){var t=Object(P.c)();return e.data.size?i.a.createElement(G.a,Object.assign({component:ne.a},e)):i.a.createElement(G.a,Object.assign({component:ne.a},e,{onRowClick:function(e,n){return t(Object(X.e)(n.name))}}))},re=n(638),ce=n.n(re),oe=n(637),ie=n.n(oe),le=Q()(function(e){return{icon:{width:48,height:48,padding:e.spacing(.5)}}});var ue=function(e){var t=e.rowData,n=le();return i.a.createElement(G.a,{display:"flex",alignItems:"center"},t.size?i.a.createElement(ce.a,{className:n.icon}):i.a.createElement(ie.a,{className:n.icon}),i.a.createElement(W.a,null," ".concat(t.name)))},me=n(229),se=n(58),de=n(228),fe=function(e,t){var n=e.storage;return t.split("/").forEach(function(e){n=n[e]}),n},pe=function(){return Object(de.a)(fe,function(e){return e?Object.entries(e).map(function(e){var t=Object(se.a)(e,2),n=t[0],a=t[1];return a.name&&a.name.constructor===String?a:{name:n}}):[]})},he=function(e){var t=e.storagePath,n="",a="",r="",c=t.split("/");return c.forEach(function(e,t){0===t?n=e:1===t?a=e:t+1<c.length&&(a+="/".concat(e)),r=e}),{id:n,fullpath:t,partialpath:a,currentpath:r}},ve=n(20),be=n(166);var ge=function(e){var t=Object(P.c)(),n=Object(P.d)(function(e){return e.target}),a=Object(P.d)(function(e){return e.dialog}),o=Object(P.d)(function(e){return e.notification});return i.a.createElement(i.a.Fragment,null,i.a.createElement(be.a,{dialogProps:{open:a===ve.a,onClose:function(){return t(Object(ve.c)())}},category:"add",title:"Add New Folder",btn:"Add New Folder",request:function(){var e=Object(c.a)(r.a.mark(function e(a){var c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.name,e.prev=1,e.next=4,L.a.post("storage/".concat(n.id,"/folder"),{path:n.path?"".concat(n.path,"/").concat(c):c});case 4:t(Object(ve.c)()),t(Object(ve.j)("Add New Folder ".concat(c),"Succeed adding new folder ".concat(c))),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),t(Object(ve.c)()),t(Object(ve.j)("Add New Folder ".concat(c),"Fail adding new folder ".concat(c,", error: ").concat(e.t0)));case 12:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(be.a,{dialogProps:{open:a===ve.f,onClose:function(){return t(Object(ve.c)())}},category:"add",title:'Rename "'.concat(n.name,'"'),btn:"Rename ".concat(n.name),request:function(){var e=Object(c.a)(r.a.mark(function e(a){var c,o,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.name,o=n.name.split(".")[1],i=o?"".concat(c,".").concat(o):c,e.prev=3,e.next=6,L.a.post("storage/".concat(n.id,"/rename"),{path:n.path,name:n.name,new_name:i});case 6:t(Object(ve.c)()),t(Object(ve.j)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Succeed renaming "'.concat(n.name,'" into "').concat(i,'"'))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),t(Object(ve.c)()),t(Object(ve.j)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Fail renaming "'.concat(n.name,'" into "').concat(i,", error: ").concat(e.t0,'"')));case 14:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(be.a,{category:"notification",title:o.title,content:o.content,dialogProps:{open:""!==o.title&&""!==o.content,onClose:function(){return t(Object(ve.d)())}}}))},je=[{title:"Name",field:"name",searchable:!0,render:function(e){return i.a.createElement(ue,{rowData:e})}},{title:"Size",field:"size",searchable:!1},{title:"Created At",field:"created",searchable:!1},{title:"Modified At",field:"modified",searchable:!1}];t.default=function(e){var t=Object(P.c)(),n=e.match.params.project,a=Object(o.useRef)(null),l=Object(o.useMemo)(me.b,[]),m=Object(P.d)(function(e){return l(e,n)}),d=Object(P.d)(he),p=Object(o.useMemo)(pe,[]),v=Object(P.d)(function(e){return p(e,d?d.fullpath:"")});return Object(o.useEffect)(function(){m&&t(Object(X.f)(m.id))},[m]),i.a.createElement(i.a.Fragment,null,i.a.createElement(ge,null),i.a.createElement(M.a,{title:i.a.createElement(ee,{title:d.partialpath?d.partialpath:"/"}),columns:je,data:v.map(function(e){return{name:e.name,size:e.size,created:e.created,modified:e.modified}}),actions:[{icon:function(){return i.a.createElement(N.a,null)},tooltip:"Upload Files",isFreeAction:!0,onClick:function(){return a.current.click()}},{icon:function(){return i.a.createElement(x.a,null)},tooltip:"Add Folder",isFreeAction:!0,onClick:function(e,n){t(Object(ve.g)({id:m.id,path:d.partialpath})),t(Object(ve.h)())}},function(e){return{icon:function(){return i.a.createElement(k.a,null)},tooltip:"Rename",onClick:function(e,n){t(Object(ve.g)({id:m.id,name:n[0].name,path:d.partialpath})),t(Object(ve.k)())},hidden:1!==e.length}},{icon:function(){return i.a.createElement(_.a,null)},tooltip:"Move",onClick:function(e,t){}},{icon:function(){return i.a.createElement(E.a,null)},tooltip:"Delete",onClick:function(){var e=Object(c.a)(r.a.mark(function e(n,a){var c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=a.map(function(e){return d.partialpath?"".concat(d.partialpath,"/").concat(e.name):e.name}),e.next=4,L.a.delete("storage/".concat(m.id),{data:{paths:c}});case 4:t(Object(ve.j)("Delete Files and Folders","Succeed deleting files and folders")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(Object(ve.j)("Delete Files and Folders","Fail deleting files and folders, error: ".concat(e.t0)));case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,n){return e.apply(this,arguments)}}()}],icons:{Search:u.a,ResetSearch:s.a,FirstPage:b.a,PreviousPage:h.a,NextPage:f.a,LastPage:j.a},components:{Body:J,Row:ae},options:{search:!1,selection:!0,paging:!1,draggable:!1,actionsColumnIndex:-1}}),i.a.createElement("input",{multiple:!0,name:"files",type:"file",style:{display:"none"},ref:a,onChange:function(){var e=Object(c.a)(r.a.mark(function e(n){var c,o,i,l,u,s,f;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log(a.current.files),e.prev=1,(c=new FormData).set("path",d.partialpath),o=!0,i=!1,l=void 0,e.prev=7,u=a.current.files[Symbol.iterator]();!(o=(s=u.next()).done);o=!0)f=s.value,c.append("file[]",f,f.name);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,l=e.t0;case 15:e.prev=15,e.prev=16,o||null==u.return||u.return();case 18:if(e.prev=18,!i){e.next=21;break}throw l;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.next=25,L.a.post("storage/".concat(m.id),c,{headers:{"Content-Type":"multipart/form-data"}});case 25:t(Object(ve.j)("Upload Files","Succeed uploading files")),e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),t(Object(ve.j)("Upload Files","Fail uploading files, error: ".concat(e.t1)));case 31:case"end":return e.stop()}},e,null,[[1,28],[7,11,15,23],[16,,18,22]])}));return function(t){return e.apply(this,arguments)}}()}))}}}]);
//# sourceMappingURL=9.a1859fe5.chunk.js.map