(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{165:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(175),c=n(170),i=n(697),l=n(698),u=n(699),s=n(700),d=n(398),m=n(360),f=n(694);var p=function(e){var t=e.request,n=e.btn,a=e.category,o=e.values,c=o.name,i=o.newName,l=o.confirmName,u=e.errors,s=e.touched,p=e.handleChange,b=e.isValid,h=e.setFieldTouched,g=function(e,t){t.persist(),p(t),h(e,!0,!1)};return r.a.createElement(f.a,{container:!0,component:"form",spacing:1,onSubmit:function(e){e.preventDefault(),t({name:c,newName:i,confirmName:l})}},"add"===a?r.a.createElement(f.a,{component:d.a,item:!0,xs:12,id:"name",name:"name",label:"Name",onChange:g.bind(null,"name"),value:c,helperText:s.name?u.name:"",error:s.name&&Boolean(u.name)}):"delete"===a?r.a.createElement(f.a,{component:d.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:g.bind(null,"confirmName"),value:l,helperText:s.confirmName?u.confirmName:"",error:s.confirmName&&Boolean(u.confirmName)}):"rename"===a?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{component:d.a,item:!0,xs:12,id:"newName",name:"newName",label:"New Name",onChange:g.bind(null,"newName"),value:i,helperText:s.newName?u.newName:"",error:s.newName&&Boolean(u.newName)}),r.a.createElement(f.a,{component:d.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:g.bind(null,"confirmName"),value:l,helperText:s.confirmName?u.confirmName:"",error:s.confirmName&&Boolean(u.confirmName)})):null,r.a.createElement(f.a,{item:!0,xs:12,component:m.a,type:"submit",disabled:!b,size:"large"},n))},b=c.object({name:c.string().required("enter name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"name too short").max(50,"name too long")}),h=c.object({name:c.string(),confirmName:c.string().required("re-enter name").matches(/^[a-z0-9_]*$/i,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).oneOf([c.ref("name")],"Confirm Name does not match")}),g=c.object({name:c.string(),confirmName:c.string().required("re-enter name").oneOf([c.ref("name")],"Confirm Name does not match"),newName:c.string().required("enter new name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"new name too short").max(50,"new name too long")}),v={name:""},y=function(e){return{name:e,confirmName:""}},O=function(e){return{name:e,confirmName:"",newName:""}};t.a=function(e){var t=e.title,n=e.content,a=e.targetName,c=e.category,d=e.dialogProps;return r.a.createElement(i.a,d,r.a.createElement(l.a,{id:"dialog-title"},t),r.a.createElement(u.a,null,"add"===c||"delete"===c||"rename"===c?r.a.createElement(r.a.Fragment,null,"delete"===c?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,null,n),r.a.createElement(s.a,null,"Please type in the name of the target to confirm")):null,r.a.createElement(o.a,{validationSchema:"add"===c?b:"rename"===c?g:"delete"===c?h:{},initialValues:"add"===c?v:"rename"===c?O(a):"delete"===c?y(a):{},render:function(t){return r.a.createElement(p,Object.assign({},e,t))}})):"notification"===c?r.a.createElement(s.a,null,n):null))}},219:function(e,t,n){"use strict";var a=n(147);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(149)).default)(r.default.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Create");t.default=o},220:function(e,t,n){"use strict";var a=n(147);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(149)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),r.default.createElement("path",{fill:"none",d:"M24 24H0V0h24v24z"})),"FirstPage");t.default=o},221:function(e,t,n){"use strict";var a=n(147);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(149)).default)(r.default.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack");t.default=o},222:function(e,t,n){"use strict";var a=n(147);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(149)).default)(r.default.createElement("path",{d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward");t.default=o},223:function(e,t,n){"use strict";var a=n(147);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(149)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"})),"LastPage");t.default=o},638:function(e,t,n){"use strict";var a=n(147);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(149)).default)(r.default.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload");t.default=o},705:function(e,t,n){"use strict";n.r(t);var a=n(15),r=n.n(a),o=n(26),c=n(0),i=n.n(c),l=n(23),u=n(256),s=n.n(u),d=n(257),m=n.n(d),f=n(222),p=n.n(f),b=n(221),h=n.n(b),g=n(220),v=n.n(g),y=n(223),O=n.n(y),j=n(205),E=n.n(j),w=n(638),k=n.n(w),N=n(219),x=n.n(N),C=n(245),P=n.n(C),M=n(35),z=n(27),F=n(314),_=n(315),L=n(363);function R(e,t){return!t||"object"!==Object(L.a)(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var B=n(36),D=n.n(B),T=(n(6),n(154));var A=function(e){function t(){return Object(F.a)(this,t),R(this,$(t).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,i.a.Component),Object(_.a)(t,[{key:"componentDidMount",value:function(){this.ref=D.a.findDOMNode(this),Object(T.b)(this.props.rootRef,this.ref)}},{key:"componentDidUpdate",value:function(e){var t=D.a.findDOMNode(this);e.rootRef===this.props.rootRef&&this.ref===t||(e.rootRef!==this.props.rootRef&&Object(T.b)(e.rootRef,null),this.ref=t,Object(T.b)(this.props.rootRef,this.ref))}},{key:"componentWillUnmount",value:function(){this.ref=null,Object(T.b)(this.props.rootRef,null)}},{key:"render",value:function(){return this.props.children}}]),t}(),H=n(368),I=n.n(H);var U=function(e){var t=Object(c.useRef)(null),n=function(e){console.log("drop mtablebody"),console.log(e.dataTransfer.files),e.preventDefault()},a=function(e){console.log("drag start mtablebody"),e.preventDefault()},r=function(e){console.log("drag end mtablebody"),e.preventDefault()},o=function(e){console.log("drag over mtablebody"),e.preventDefault()},l=function(){return console.log("click")};return Object(c.useEffect)(function(){return t.current.addEventListener("drop",n),t.current.addEventListener("dragstart",a),t.current.addEventListener("dragend",r),t.current.addEventListener("dragover",o),t.current.addEventListener("click",l),function(){t.current.removeEventListener("drop",n),t.current.removeEventListener("dragstart",a),t.current.removeEventListener("dragend",r),t.current.removeEventListener("dragover",o),t.current.removeEventListener("click",l)}},[]),i.a.createElement(A,{rootRef:t},i.a.createElement(I.a,e))},q=n(139),V=n(312),Z=n(3),J=n(12),G=n(25),K=n(62),W=n(38),X=n(63),Y=n(369),Q=i.a.forwardRef(function(e,t){var n=e.classes,a=e.className,r=e.color,o=void 0===r?"secondary":r,c=e.edge,l=void 0!==c&&c,u=e.size,s=void 0===u?"medium":u,d=Object(J.a)(e,["classes","className","color","edge","size"]),m=i.a.createElement("span",{className:n.thumb});return i.a.createElement("span",{className:Object(G.a)(n.root,a,{start:n.edgeStart,end:n.edgeEnd}[l],{small:n["size".concat(Object(X.a)(s))]}[s])},i.a.createElement(Y.a,Object(Z.a)({type:"checkbox",icon:m,checkedIcon:m,classes:{root:Object(G.a)(n.switchBase,n["color".concat(Object(X.a)(o))]),input:n.input,checked:n.checked,disabled:n.disabled},ref:t},d)),i.a.createElement("span",{className:n.track}))}),ee=Object(K.a)(function(e){return{root:{display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle"},edgeStart:{marginLeft:-8},edgeEnd:{marginRight:-8},switchBase:{position:"absolute",top:0,left:0,zIndex:1,color:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[400],transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),willChange:"left, transform","&$checked":{left:"100%",transform:"translateX(-100%)"},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{opacity:.5},"&$disabled + $track":{opacity:"light"===e.palette.type?.12:.1}},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(W.c)(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.primary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(W.c)(e.palette.secondary.main,e.palette.action.hoverOpacity)}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.secondary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},sizeSmall:{width:40,height:24,padding:7,"& $thumb":{width:16,height:16},"& $switchBase":{padding:4}},checked:{},disabled:{},input:{left:"-100%",width:"300%"},thumb:{boxShadow:e.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},track:{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.type?.38:.3}}},{name:"MuiSwitch"})(Q),te=n(19);var ne=function(e){var t=e.rowData,n=Object(M.c)();return i.a.createElement(q.a,{display:"flex",alignItems:"center"},i.a.createElement(ee,{checked:t.isPublic,onChange:function(){var e=Object(o.a)(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.b.post("storage/".concat(t.id,"/public"));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),n(Object(te.m)("Toggle File Access","Fail toggling file access, error: ".concat(e.t0)));case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(V.a,null,t.isPublic?"Public":"Private"))},ae=n(229),re=n(230),oe=function(e){return e.storage},ce=function(){return Object(ae.a)(oe,function(e,t){return Object(re.b)()(e,t)},function(e,t){return t?{project:t,storage:Object.values(e).filter(function(e){return e.project_id===t.id})}:null})},ie=n(165);var le=function(e){var t=Object(M.c)(),n=Object(M.d)(function(e){return e.target}),a=Object(M.d)(function(e){return e.dialog}),c=Object(M.d)(function(e){return e.notification});return i.a.createElement(i.a.Fragment,null,i.a.createElement(ie.a,{dialogProps:{open:a===te.h,onClose:function(){return t(Object(te.d)())}},category:"add",title:'Rename "'.concat(n.name,'"'),btn:"Rename ".concat(n.name),request:function(){var e=Object(o.a)(r.a.mark(function e(a){var o,c,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.name,c=n.name.split(".")[1],i=c?"".concat(o,".").concat(c):o,e.prev=3,e.next=6,z.b.post("storage/".concat(n.id,"/rename"),{name:i});case 6:t(Object(te.d)()),t(Object(te.m)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Succeed renaming "'.concat(n.name,'" into "').concat(i,'"'))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),t(Object(te.d)()),t(Object(te.m)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Fail renaming "'.concat(n.name,'" into "').concat(i,", error: ").concat(e.t0,'"')));case 14:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(ie.a,{category:"notification",title:c.title,content:c.content,dialogProps:{open:""!==c.title&&""!==c.content,onClose:function(){return t(Object(te.e)())}}}))},ue=[{title:"#",field:"#",searchable:!1},{field:"id",searchable:!1,hidden:!0},{title:"Name",field:"name",searchable:!0},{title:"Size",field:"size",searchable:!1},{title:"Created At",field:"created",searchable:!1},{title:"Modified At",field:"modified",searchable:!1},{title:"Is Public?",field:"isPublic",render:function(e){return i.a.createElement(ne,{rowData:e})}}];t.default=function(e){var t=Object(M.c)(),n=e.match.params.project,a=Object(c.useRef)(null),u=Object(c.useMemo)(ce,[]),d=Object(M.d)(function(e){return u(e,n)});return d?i.a.createElement(i.a.Fragment,null,i.a.createElement(le,null),i.a.createElement(P.a,{title:"Storage",columns:ue,data:d.storage.map(function(e,t){var n=e.size;if(0===n)n="0 Bytes";else{var a=Math.floor(Math.log(n)/Math.log(1024));n=parseFloat((n/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}return{"#":t+1,id:e.id,name:e.name,size:n,created:e.created,modified:e.modified,isPublic:e.isPublic}}),actions:[{icon:function(){return i.a.createElement(k.a,null)},tooltip:"Upload Files",isFreeAction:!0,onClick:function(){return a.current.click()}},function(e){return{icon:function(){return i.a.createElement(x.a,null)},tooltip:"Rename",onClick:function(e,n){t(Object(te.i)({id:n[0].id,name:n[0].name})),t(Object(te.n)())},hidden:1!==e.length}},{icon:function(){return i.a.createElement(E.a,null)},tooltip:"Delete",onClick:function(){var e=Object(o.a)(r.a.mark(function e(n,a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.b.delete("storage",{data:{ids:a.map(function(e){return e.id})}});case 3:t(Object(te.m)("Delete Files","Succeed deleting files")),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t(Object(te.m)("Delete Files","Fail deleting files, error: ".concat(e.t0)));case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,n){return e.apply(this,arguments)}}()}],onRowClick:function(e,t){var a="/storage/stream/".concat(n,"/").concat(t.name);window.open(a)},icons:{Search:s.a,ResetSearch:m.a,FirstPage:v.a,PreviousPage:h.a,NextPage:p.a,LastPage:O.a},components:{Body:U},options:{search:!1,selection:!0,paging:!1,draggable:!1,actionsColumnIndex:-1}}),i.a.createElement("input",{multiple:!0,name:"files",type:"file",style:{display:"none"},ref:a,onChange:function(){var e=Object(o.a)(r.a.mark(function e(n){var o,c,i,l,u,s,m;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log(a.current.files),e.prev=1,o=new FormData,c=!0,i=!1,l=void 0,e.prev=6,u=a.current.files[Symbol.iterator]();!(c=(s=u.next()).done);c=!0)m=s.value,o.append("file[]",m,m.name);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),i=!0,l=e.t0;case 14:e.prev=14,e.prev=15,c||null==u.return||u.return();case 17:if(e.prev=17,!i){e.next=20;break}throw l;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return e.next=24,z.b.post("storage/".concat(d.project.id),o,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){t(Object(te.j)(e.loaded,e.total))},cancelToken:new z.a(function(e){t(Object(te.g)(e))})});case 24:t(Object(te.m)("Upload Files","Succeed uploading files")),e.next=31;break;case 27:e.prev=27,e.t1=e.catch(1),t(Object(te.b)()),t(Object(te.m)("Upload Files","Fail uploading files, error: ".concat(e.t1)));case 31:case"end":return e.stop()}},e,null,[[1,27],[6,10,14,22],[15,,17,21]])}));return function(t){return e.apply(this,arguments)}}()})):i.a.createElement(l.a,{to:"/"})}}}]);
//# sourceMappingURL=11.772e6cd0.chunk.js.map