(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{203:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l});var a=n(220),r=n(221),c=function(e){return e.entities},o=function(e){return Object.values(c(e))},i=function(){return Object(a.a)(o,function(e,t){return t},function(e,t){return e.filter(function(e){return e.projectId===t})})},u=function(){return Object(a.a)(o,function(e,t){return Object(r.b)()(e,t)},function(e,t){return t?{project:t,entities:e.filter(function(e){return e.projectId===t.id})}:null})},l=function(){return Object(a.a)(o,function(e,t,n){return Object(r.b)()(e,t)},function(e,t,n){return n},function(e,t,n){return t?e.find(function(e){return e.name===n&&e.projectId===t.id}):null})}},205:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(690),o=n(702);t.a=function(e){return r.a.createElement(o.a,Object.assign({minHeight:"100vh",component:c.a,maxWidth:"xl"},e),e.children)}},221:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return o});var a=n(220),r=function(e){return e.projects},c=function(e){return Object.values(r(e))},o=function(){return Object(a.a)(c,function(e,t){return t},function(e,t){return e.find(function(e){return e.name===t})})}},223:function(e,t,n){"use strict";n.d(t,"f",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"b",function(){return m}),n.d(t,"e",function(){return b}),n.d(t,"c",function(){return E}),n.d(t,"d",function(){return j});var a=n(13),r=n.n(a),c=n(25),o=n(309),i=n(260),u=n(311),l=n(203),d=n(26),s=n(310);function f(e){return{type:"SET_PROJECT_POPOVER",anchor:e}}var p=function(e){return{type:"ADD_PROJECTS",projects:e}},m=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n,a){var c,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(l.a)(),i=c(a(),e),n(Object(o.b)(i.map(function(e){return e.id}))),n({type:"DELETE_PROJECT",id:e});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},b=function(e,t,n,a){return{type:"RENAME_PROJECT",id:e,name:t,updated:n,publicKey:a}},E=function(e,t,n){return{type:"IMG_PROJECT",id:e,img:t,updated:n}},j=function(){return function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,c,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get("project");case 3:n=e.sent,a=Object(s.b)(n.data),c=[],l=[],a.result.forEach(function(e){c.push({id:a.entities.projects[e].id,name:a.entities.projects[e].name,img:a.entities.projects[e].img_url,created:a.entities.projects[e].created_at,updated:a.entities.projects[e].updated_at,publicKey:a.entities.projects[e].public_key}),t(p(c)),a.entities.projects[e].entities.forEach(function(e){l.push({id:a.entities.entities[e].id,projectId:a.entities.entities[e].project_id,name:a.entities.entities[e].name,created:a.entities.entities[e].created_at,updated:a.entities.entities[e].updated_at})})}),t(Object(o.a)(l)),l.forEach(function(e){return t(Object(i.c)(e.id))}),c.forEach(function(e){return t(Object(u.b)(e.id))}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,null,[[0,13]])}));return function(t){return e.apply(this,arguments)}}()}},260:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return s});var a=n(13),r=n.n(a),c=n(25),o=n(310),i=n(26),u=function(e){return{type:"ADD_DOCUMENTS",documents:e}},l=function(e){return{type:"DELETE_DOCUMENTS",documents:e}},d=function(e,t,n){return{type:"MODIFY_DOCUMENT",id:e,updated:t,data:n}},s=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n){var a,c,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.get("document/".concat(e));case 3:a=t.sent,c=Object(o.a)(a.data),l=[],c.result.forEach(function(e){l.push({id:c.entities.documents[e].id,entityId:c.entities.documents[e].entity_id,created:c.entities.documents[e].created_at,updated:c.entities.documents[e].updated_at,data:c.entities.documents[e].data})}),n({type:"SET_DOCUMENT_INIT",entityId:e}),n(u(l)),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}},t,null,[[0,11]])}));return function(e){return t.apply(this,arguments)}}()}},261:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l});var a=n(220),r=n(203),c=function(e){return e.documents},o=function(e,t){return c(e)[t]},i=function(e){return Object.values(c(e))},u=function(){return Object(a.a)(i,function(e,t){return t},function(e,t){return e.filter(function(e){return e.entityId===t})})},l=function(){return Object(a.a)(i,function(e,t,n){return Object(r.c)()(e,t,n)},function(e,t){return t?{entity:t,documents:e.filter(function(e){return e.entityId===t.id})}:null})}},309:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d});var a=n(13),r=n.n(a),c=n(25),o=n(260),i=n(261),u=function(e){return{type:"ADD_ENTITIES",entities:e}},l=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n,a){var c,u;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(i.b)(),u=[],e.forEach(function(e){c(a(),e).forEach(function(e){return u.push(e.id)})}),n(Object(o.b)(u)),n({type:"DELETE_ENTITIES",entities:e});case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},d=function(e,t,n){return{type:"RENAME_ENTITY",id:e,name:t,updated:n}}},310:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return s});var a=n(420),r=new a.b.Entity("documents",{},{idAttribute:"id"}),c=new a.b.Array(r),o=new a.b.Entity("entities",{documents:c},{idAttribute:"id"}),i=new a.b.Array(o),u=new a.b.Entity("projects",{entities:i},{idAttribute:"id"}),l=new a.b.Array(u);function d(e){return Object(a.a)(e,l)}function s(e){return Object(a.a)(e,c)}},311:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"b",function(){return s});var a=n(13),r=n.n(a),c=n(25),o=n(26),i=function(e){return{type:"UPLOAD_STORAGE",files:e}},u=function(e,t,n){return{type:"RENAME_STORAGE",id:e,name:t,updated:n}},l=function(e,t,n){return{type:"PUBLIC_STORAGE",id:e,isPublic:t,updated:n}},d=function(e){return{type:"DELETE_STORAGE",ids:e}},s=function(e){return function(){var t=Object(c.a)(r.a.mark(function t(n){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.get("storage/".concat(e));case 3:a=t.sent,n(i(a.data)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()}},704:function(e,t,n){"use strict";n.r(t);var a=n(217),r=n(0),c=n.n(r),o=n(22),i=n(161),u=n.n(i),l=n(33),d=n(304),s=n(682),f=n(298),p=n(299),m=n(397),b=n(702),E=n(415),j=n.n(E),g=n(414),O=n.n(g),h=n(413),v=n.n(h),y=n(45),_=n(18),w=n(60),x=n(58),k=n(46);var T=function(e){var t=e.location,n=Object(r.useState)({}),a=Object(x.a)(n,2),i=a[0],u=a[1];Object(r.useEffect)(function(){var e=(t.pathname.match(/\/./g)||[]).length;0===e?u({}):1===e?u(Object(o.f)(t.pathname,{path:"/:project",exact:!0}).params):2===e?u(Object(o.f)(t.pathname,{path:"/:project/:entity",exact:!0}).params):3===e&&u(Object(o.f)(t.pathname,{path:"/:project/:entity/:document",exact:!0}).params)},[t.pathname]);var l=i.project,d=i.entity,s=i.document;return c.a.createElement(c.a.Fragment,null,c.a.createElement(k.b,{to:"/"}," StarfallCMS "),l?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(k.b,{to:"/".concat(l)}," ",l," ")):null,d?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(k.b,{to:"/".concat(l,"/").concat(d)}," ",d," ")):null,s?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(k.b,{to:"/".concat(l,"/").concat(d,"/").concat(s)}," ",s," ")):null)},N=u()(function(e){return{root:Object(a.a)({backgroundColor:e.palette.primary.light},e.responsive),link:{"& a":{color:"black",paddingLeft:e.spacing(.35),paddingRight:e.spacing(.35),fontSize:"115%"},whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},hide:e.hide}});var S=function(e){var t=e.history,n=N(),a=Object(l.c)(),r=Object(l.d)(function(e){return e.sidebar}),o=Object(l.d)(function(e){return e.authStatus});return c.a.createElement(c.a.Fragment,null,c.a.createElement(s.a,{position:"fixed",className:n.root},c.a.createElement(f.a,null,c.a.createElement(m.a,{mdUp:!0},c.a.createElement(p.a,{color:"inherit","aria-label":"Open drawer",onClick:function(){return a(Object(_.l)(!r))},edge:"start",className:Object(y.a)(r&&n.hide)},c.a.createElement(v.a,null))),c.a.createElement(b.a,{display:"flex",flexGrow:1,container:d.a,variant:"h6",align:"center",className:n.link},c.a.createElement(T,e)),o===w.d?c.a.createElement(p.a,{edge:"end","aria-label":"Account of current user","aria-haspopup":"true",color:"inherit",onClick:function(e){return t.push("/userlist")}},c.a.createElement(O.a,null)):null,c.a.createElement(p.a,{edge:"end","aria-label":"Log Off","aria-haspopup":"true",color:"inherit",onClick:function(e){return a(Object(w.b)())}},c.a.createElement(j.a,null)))))},C=u()(function(e){return{root:Object(a.a)({backgroundColor:"#292D2E"},e.responsive),text:{color:"white",fontSize:"125%",textAlign:"center",lineHeight:"50px"}}});var P=function(){var e=C();return c.a.createElement("footer",{className:e.root},c.a.createElement(d.a,{variant:"h3",className:e.text},"Copyright Starfall Production"))},I=n(712),A=n(689),D=n(418),R=n.n(D),M=n(419),F=n.n(M),L=n(685),z=n(683),G=n(305),U=n(707),J=n(684),K=n(416),B=n.n(K),H=n(417),Y=n.n(H),V=u()({root:{flexGrow:1}});var W=function(e){var t=V(),n=e.name,a=e.projectName;return c.a.createElement(c.a.Fragment,null,c.a.createElement(z.a,{divider:!0},c.a.createElement(U.a,{component:k.b,to:"/".concat(a,"/").concat(n),className:t.root},c.a.createElement(G.a,{primary:n}))))},q=n(203),Q=u()(function(e){return{root:{paddingLeft:e.spacing(1)},hide:{display:"none"},btn:{flexGrow:1}}});var X=function(e){var t=Q(),n=e.id,a=e.name,o=Object(r.useMemo)(q.a,[]),i=Object(l.d)(function(e){return o(e,n)}),u=Object(r.useState)(!1),d=Object(x.a)(u,2),s=d[0],f=d[1],m=Object(r.useState)(!1),b=Object(x.a)(m,2),E=b[0],j=b[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(z.a,{button:!0,divider:!0,onClick:function(){return f(!s)}},c.a.createElement(G.a,{primary:a}),s?c.a.createElement(B.a,null):c.a.createElement(Y.a,null)),c.a.createElement(J.a,{in:s,timeout:"auto",unmountOnExit:!0},c.a.createElement(L.a,{className:t.root,disablePadding:!0},c.a.createElement(z.a,{button:!0,component:k.b,to:"/".concat(a,"/storage"),divider:!0},c.a.createElement(G.a,{primary:"Storage"})),c.a.createElement(z.a,{divider:!0},c.a.createElement(U.a,{component:k.b,to:"/".concat(a),className:t.btn},c.a.createElement(G.a,{primary:"Entities"})),c.a.createElement(p.a,{color:"inherit","aria-label":"Expand ".concat(a," entities"),onClick:function(){return j(!E)},edge:"end",className:Object(y.a)(0===i.length&&t.hide)},E?c.a.createElement(B.a,null):c.a.createElement(Y.a,null))),i.length>0?c.a.createElement(J.a,{in:E,timeout:"auto",unmountOnExit:!0},c.a.createElement(L.a,{className:t.root,disablePadding:!0},i.map(function(e){return c.a.createElement(W,{key:e.id,name:e.name,projectName:a})}))):null)))},Z=n(221);var $=function(e){var t=Object(l.d)(Z.a);return c.a.createElement(L.a,null,c.a.createElement(z.a,{button:!0,component:k.b,to:"/",divider:!0},c.a.createElement(G.a,{primary:"Overview"})),t.map(function(e){return c.a.createElement(X,{id:e.id,name:e.name,key:e.id})}))},ee=u()(function(e){return{root:e.sidebar,paper:Object(a.a)({backgroundColor:e.palette.primary.main},e.sidebarPaper),direction:e.direction,btn:Object(a.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar,{justifyContent:"flex-end"})}});var te=function(e){var t=ee(),n=Object(l.c)(),a=Object(l.d)(function(e){return e.sidebar});return c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{mdUp:!0},c.a.createElement(I.a,{className:t.root,variant:"temporary",anchor:"rtl"===t.direction?"right":"left",open:a,classes:{paper:t.paper},ModalProps:{keepMounted:!0}},c.a.createElement("div",{className:t.btn},c.a.createElement(p.a,{onClick:function(){return n(Object(_.l)(!a))}},"ltr"===t.direction?c.a.createElement(R.a,null):c.a.createElement(F.a,null))),c.a.createElement(A.a,null),c.a.createElement($,null))),c.a.createElement(m.a,{smDown:!0},c.a.createElement(I.a,{className:t.root,classes:{paper:t.paper},variant:"permanent",open:!0},c.a.createElement($,null))))},ne=n(223),ae=n(205),re=n(421),ce=n.n(re),oe=n(309),ie=n(260),ue=n(311);var le=function(e){var t=Object(l.c)();return Object(r.useEffect)(function(){var e=ce()(null,{path:"starfall-cms-ws"});return e.on("open",function(){var n=e.subscribe("project"),a=e.subscribe("entity"),r=e.subscribe("document"),c=e.subscribe("storage");n.on("add",function(e){console.log("add project"),console.log(e),t(Object(ne.a)([{id:e.id,name:e.name,img:e.img_url,created:e.created_at,updated:e.updated_at,publicKey:e.public_key}]))}),n.on("delete",function(e){console.log("delete project"),console.log(e),t(Object(ne.b)(e.id))}),n.on("rename",function(e){console.log("rename project"),console.log(e),t(Object(ne.e)(e.id,e.name,e.updated_at,e.public_key))}),n.on("img",function(e){console.log("change image of project"),console.log(e),t(Object(ne.c)(e.id,e.img_url,e.updated_at))}),n.on("error",function(e){console.log(e)}),a.on("add",function(e){console.log("add entity"),console.log(e),t(Object(oe.a)([{id:e.id,projectId:e.project_id,name:e.name,created:e.created_at,updated:e.updated_at}]))}),a.on("delete",function(e){console.log("delete entity"),console.log(e),t(Object(oe.b)([e.id]))}),a.on("rename",function(e){console.log("rename entity"),console.log(e),t(Object(oe.c)(e.id,e.name,e.updated_at))}),a.on("error",function(e){console.log(e)}),r.on("add",function(e){console.log("add document"),console.log(e),t(Object(ie.a)([{id:e.id,entityId:e.entity_id,created:e.created_at,updated:e.updated_at,data:e.data}]))}),r.on("modify",function(e){console.log("modify document"),console.log(e),t(Object(ie.d)(e.id,e.updated_at,e.data))}),r.on("delete",function(e){console.log("delete documents"),console.log(e),t(Object(ie.b)(e.ids))}),c.on("upload",function(e){console.log("upload into storage"),console.log(e),t(Object(ue.e)(e))}),c.on("rename",function(e){console.log("rename storage"),console.log(e),t(Object(ue.d)(e.id,e.name,e.updated_at))}),c.on("public",function(e){console.log("toggle isPublic storage"),console.log(e),t(Object(ue.c)(e.id,e.isPublic,e.updated_at))}),c.on("delete",function(e){console.log("delete storage"),console.log(e),t(Object(ue.a)(e.ids))})}),e.on("close",function(){}),e.on("error",function(e){console.log(e)}),e.connect(),function(){e.close()}},[]),null},de=Object(r.lazy)(function(){return n.e(17).then(n.bind(null,705))}),se=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(12)]).then(n.bind(null,711))}),fe=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(16)]).then(n.bind(null,699))}),pe=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(15)]).then(n.bind(null,700))}),me=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(13)]).then(n.bind(null,703))}),be=Object(r.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(14)]).then(n.bind(null,709))}),Ee=u()(function(e){return{root:Object(a.a)({marginTop:65,paddingTop:15,paddingBottom:15,backgroundColor:e.palette.background.light.light,overflow:"auto"},e.responsive)}});t.default=function(e){var t=Ee(),n=Object(l.c)(),a=Object(l.d)(function(e){return e.authStatus});return Object(r.useEffect)(function(){n(Object(ne.d)())},[]),a===w.g?c.a.createElement(o.a,{to:"/signup"}):a===w.i?c.a.createElement(o.a,{to:"/signin"}):c.a.createElement(c.a.Fragment,null,c.a.createElement(S,e),c.a.createElement(te,null),c.a.createElement(le,null),c.a.createElement(ae.a,{className:t.root},c.a.createElement(r.Suspense,{fallback:c.a.createElement("div",null)},c.a.createElement(o.d,null,a===w.d?c.a.createElement(o.b,{path:"/userlist",component:be}):null,c.a.createElement(o.b,{path:"/:project/:entity/:document",component:pe}),c.a.createElement(o.b,{path:"/:project/storage",component:me}),c.a.createElement(o.b,{path:"/:project/:entity",component:fe}),c.a.createElement(o.b,{path:"/:project",component:se}),c.a.createElement(o.b,{path:"/",component:de})))),c.a.createElement(P,null))}}}]);
//# sourceMappingURL=8.6f739db3.chunk.js.map