(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{123:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"f",function(){return s}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"g",function(){return p}),n.d(t,"e",function(){return b});var r=n(13),a=n.n(r),c=n(22),o=n(281),i=n(23);function u(e,t){return{type:"ADD_FIELD",keys:e,fieldType:t}}function l(e,t){return{type:"SET_FIELD",keys:e,value:t}}function d(e){return{type:"DELETE_FIELD",keys:e}}function s(e){return{type:"GENERATE_FIELD",fieldType:e,data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}}}var f=function(e){return{type:"ADD_DOCUMENTS",documents:e}},m=function(e){return{type:"DELETE_DOCUMENTS",documents:e}},p=function(e,t,n){return{type:"MODIFY_DOCUMENT",id:e,updated:t,data:n}},b=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n){var r,c,u;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.get("document/".concat(e));case 3:r=t.sent,c=Object(o.a)(r.data),u=[],c.result.forEach(function(e){u.push({id:c.entities.documents[e]._id,entityId:c.entities.documents[e].entity_id,created:c.entities.documents[e].created_at,updated:c.entities.documents[e].updated_at,data:c.entities.documents[e].data})}),n({type:"SET_DOCUMENT_INIT",entityId:e}),n(f(u)),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}},t,null,[[0,11]])}));return function(e){return t.apply(this,arguments)}}()}},131:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m}),n.d(t,"d",function(){return p});var r=n(195),a=n(149),c=function(e){return e.documents},o=function(e,t){return c(e)[t]},i=function(e){return Object.values(c(e))},u=function(){return Object(r.a)(i,function(e,t){return t},function(e,t){return e.filter(function(e){return e.entityId===t})})},l=function(){return Object(r.a)(i,function(e,t){return Object(a.c)()(e,t)},function(e,t){return{entity:t,documents:e.filter(function(e){return e.entityId===t.id})}})},d=function(e){return e.currentDocument},s=function(e){return d(e).type},f=function(e){return d(e).data},m=function(){return Object(r.a)(s,function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]},function(e,t){return t.forEach(function(t){e.constructor===Object?e=e[t]:e.constructor===Array&&(e=e[0])}),e.constructor===Object?Object.entries(e).map(function(e){return{key:e[0],type:e[1].constructor===Object?"object":e[1].constructor===Array?"array":e[1]}}):e.constructor===Array?{key:0,type:e[0].constructor===Object?"object":e[0].constructor===Array?"array":e[0]}:void 0})},p=function(){return Object(r.a)(f,function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]},function(e,t){return t.forEach(function(t){e[t]&&(e=e[t])}),e})}},149:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l});var r=n(195),a=n(196),c=function(e){return e.entities},o=function(e){return Object.values(c(e))},i=function(){return Object(r.a)(o,function(e,t){return t},function(e,t){return e.filter(function(e){return e.projectId===t})})},u=function(){return Object(r.a)(o,function(e,t){return Object(a.b)()(e,t)},function(e,t){return{project:t,entities:e.filter(function(e){return e.projectId===t.id})}})},l=function(){return Object(r.a)(o,function(e,t){return t},function(e,t){return e.find(function(e){return e.name===t})})}},174:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"i",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return s}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return m}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return b});var r=n(13),a=n.n(r),c=n(22),o=n(23),i=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.get("storage/".concat(e));case 3:r=t.sent,n({type:"INIT_STORAGE",id:e,data:r.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()},u=function(e,t,n){return{type:"UPLOAD_STORAGE",id:e,path:t,files:n}},l=function(e,t){return{type:"FOLDER_STORAGE",id:e,path:t}},d=function(e,t,n){return{type:"MOVE_STORAGE",id:e,path:t,targets:n}},s=function(e,t,n,r){return{type:"RENAME_STORAGE",id:e,path:t,name:n,new_name:r}},f=function(e,t){return{type:"DELETE_STORAGE",id:e,paths:t}};function m(e){return{type:"INIT_STORAGE_PATH",id:e}}function p(e){return{type:"FORWARD_STORAGE_PATH",next:e}}function b(){return{type:"BACKWARD_STORAGE_PATH"}}},175:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(675),o=n(664);t.a=function(e){return a.a.createElement(c.a,Object.assign({minHeight:"100vh",component:o.a,maxWidth:"xl"},e),e.children)}},196:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return o});var r=n(195),a=function(e){return e.projects},c=function(e){return Object.values(a(e))},o=function(){return Object(r.a)(c,function(e,t){return t},function(e,t){return e.find(function(e){return e.name===t})})}},197:function(e,t,n){"use strict";n.d(t,"f",function(){return f}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return b}),n.d(t,"c",function(){return E}),n.d(t,"d",function(){return j});var r=n(13),a=n.n(r),c=n(22),o=n(280),i=n(123),u=n(174),l=n(149),d=n(23),s=n(281);function f(e){return{type:"SET_PROJECT_POPOVER",anchor:e}}var m=function(e){return{type:"ADD_PROJECTS",projects:e}},p=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n,r){var c,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(l.a)(),i=c(r(),e),n(Object(o.b)(i.map(function(e){return e.id}))),n({type:"DELETE_PROJECT",id:e});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},b=function(e,t,n){return{type:"RENAME_PROJECT",id:e,name:t,updated:n}},E=function(e,t,n){return{type:"IMG_PROJECT",id:e,img:t,updated:n}},j=function(){return function(){var e=Object(c.a)(a.a.mark(function e(t){var n,r,c,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get("project");case 3:n=e.sent,r=Object(s.b)(n.data),c=[],l=[],r.result.forEach(function(e){c.push({id:r.entities.projects[e]._id,name:r.entities.projects[e].name,img:r.entities.projects[e].img_url,created:r.entities.projects[e].created_at,updated:r.entities.projects[e].updated_at,publicKey:r.entities.projects[e].public_key}),t(m(c)),r.entities.projects[e].entities.forEach(function(e){l.push({id:r.entities.entities[e]._id,projectId:r.entities.entities[e].project_id,name:r.entities.entities[e].name,created:r.entities.entities[e].created_at,updated:r.entities.entities[e].updated_at,schema:r.entities.entities[e].schema||{}})})}),t(Object(o.a)(l)),l.forEach(function(e){return t(Object(i.e)(e.id))}),c.forEach(function(e){return t(Object(u.c)(e.id))}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,null,[[0,13]])}));return function(t){return e.apply(this,arguments)}}()}},264:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(644),o=n(263),i=n(272),u=n(275);function l(e){var t=e.IconComponent;return t?a.a.createElement(c.a,null,a.a.createElement(t,null)):null}t.a=function(e){var t=e.menus;return a.a.createElement(o.a,e,t.map(function(e,t){var n=e.title?e.title:"",r=e.onClick?e.onClick:function(){};return a.a.createElement(i.a,{key:t,onClick:r},a.a.createElement(l,{IconComponent:e.icon}),a.a.createElement(u.a,null,n))}))}},280:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return s});var r=n(13),a=n.n(r),c=n(22),o=n(123),i=n(131),u=function(e){return{type:"ADD_ENTITIES",entities:e}},l=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n,r){var c,u;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(i.f)(),u=[],e.forEach(function(e){c(r(),e).forEach(function(e){return u.push(e.id)})}),n(Object(o.c)(u)),n({type:"DELETE_ENTITIES",entities:e});case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},d=function(e,t,n){return{type:"RENAME_ENTITY",id:e,name:t,updated:n}},s=function(e,t,n){return{type:"SET_ENTITY_SCHEMA",id:e,schema:t,updated:n}}},281:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return s});var r=n(376),a=new r.b.Entity("documents",{},{idAttribute:"_id"}),c=new r.b.Array(a),o=new r.b.Entity("entities",{documents:c},{idAttribute:"_id"}),i=new r.b.Array(o),u=new r.b.Entity("projects",{entities:i},{idAttribute:"_id"}),l=new r.b.Array(u);function d(e){return Object(r.a)(e,l)}function s(e){return Object(r.a)(e,c)}},677:function(e,t,n){"use strict";n.r(t);var r=n(191),a=n(0),c=n.n(a),o=n(18),i=n(40),u=n(63),l=n(653),d=n(276),s=n(361),f=n(277),m=n(675),p=n(275),b=n(26),E=n(654),j=n(655),O=n(111),g=n(21),h=n(650),y=n(652),v=n(264),_=n(43);var T=function(e){var t=e.anchor,n=e.close,r=Object(b.c)();return c.a.createElement(v.a,{id:t?"User":null,open:!!t,onClose:function(){return n()},anchorEl:t,menus:[{title:"User List",icon:h.a,onClick:function(){}},{title:"Sign Out",icon:y.a,onClick:function(){return r(Object(_.b)())}}]})},k=n(35);var A=function(e){var t=e.location,n=Object(a.useState)({}),r=Object(i.a)(n,2),u=r[0],l=r[1];Object(a.useEffect)(function(){var e=(t.pathname.match(/\/./g)||[]).length;0===e?l({}):1===e?l(Object(o.f)(t.pathname,{path:"/:project",exact:!0}).params):2===e?l(Object(o.f)(t.pathname,{path:"/:project/:entity",exact:!0}).params):3===e&&l(Object(o.f)(t.pathname,{path:"/:project/:entity/:document",exact:!0}).params)},[t.pathname]);var d=u.project,s=u.entity,f=u.document;return c.a.createElement(c.a.Fragment,null,c.a.createElement(k.b,{to:"/"}," StarfallCMS "),d?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(k.b,{to:"/".concat(d)}," ",d," ")):null,s?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(k.b,{to:"/".concat(d,"/").concat(s)}," ",s," ")):null,f?c.a.createElement(c.a.Fragment,null,"/",c.a.createElement(k.b,{to:"/".concat(d,"/").concat(s,"/").concat(f)}," ",f," ")):null)},w=Object(u.a)(function(e){return{root:Object(r.a)({backgroundColor:e.palette.primary.light},e.responsive),link:{"& a":{color:"black",paddingLeft:e.spacing(.35),paddingRight:e.spacing(.35),fontSize:"115%"},whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},hide:e.hide}});var x=function(e){var t=w(),n=Object(b.c)(),r=Object(b.d)(function(e){return e.sidebar}),o=Object(a.useState)(null),u=Object(i.a)(o,2),h=u[0],y=u[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(l.a,{position:"fixed",className:t.root},c.a.createElement(d.a,null,c.a.createElement(s.a,{mdUp:!0},c.a.createElement(f.a,{color:"inherit","aria-label":"Open drawer",onClick:function(){return n(Object(g.m)(!r))},edge:"start",className:Object(O.a)(r&&t.hide)},c.a.createElement(E.a,null))),c.a.createElement(m.a,{display:"flex",flexGrow:1,container:p.a,variant:"h6",align:"center",className:t.link},c.a.createElement(A,e)),c.a.createElement(f.a,{edge:"end","aria-label":"Account of current user","aria-haspopup":"true",color:"inherit",onClick:function(e){return y(e.currentTarget)}},c.a.createElement(j.a,null)))),c.a.createElement(T,{anchor:h,close:function(){return y(null)}}))},S=Object(u.a)(function(e){return{root:Object(r.a)({backgroundColor:"#292D2E"},e.responsive),text:{color:"white",fontSize:"125%",textAlign:"center",lineHeight:"50px"}}});var C=function(){var e=S();return c.a.createElement("footer",{className:e.root},c.a.createElement(p.a,{variant:"h3",className:e.text},"Copyright Starfall Production"))},N=n(684),I=n(663),D=n(661),R=n(662),P=n(648),F=n(649),M=n(279),G=n(658),L=n(681),U=n(656),z=n(657),J=Object(u.a)({root:{flexGrow:1}});var H=function(e){var t=J(),n=e.name,r=e.projectName;return c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,{divider:!0},c.a.createElement(L.a,{component:k.b,to:"/".concat(r,"/").concat(n),className:t.root},c.a.createElement(M.a,{primary:n}))))},K=n(149),W=Object(u.a)(function(e){return{root:{paddingLeft:e.spacing(1)},hide:{display:"none"},btn:{flexGrow:1}}});var Y=function(e){var t=W(),n=e.id,r=e.name,o=Object(a.useMemo)(K.a,[]),u=Object(b.d)(function(e){return o(e,n)}),l=Object(a.useState)(!1),d=Object(i.a)(l,2),s=d[0],m=d[1],p=Object(a.useState)(!1),E=Object(i.a)(p,2),j=E[0],g=E[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(F.a,{button:!0,divider:!0,onClick:function(){return m(!s)}},c.a.createElement(M.a,{primary:r}),s?c.a.createElement(U.a,null):c.a.createElement(z.a,null)),c.a.createElement(G.a,{in:s,timeout:"auto",unmountOnExit:!0},c.a.createElement(P.a,{className:t.root,disablePadding:!0},c.a.createElement(F.a,{button:!0,component:k.b,to:"/".concat(r,"/authentication"),divider:!0},c.a.createElement(M.a,{primary:"Authentication"})),c.a.createElement(F.a,{button:!0,component:k.b,to:"/".concat(r,"/storage"),divider:!0},c.a.createElement(M.a,{primary:"Storage"})),c.a.createElement(F.a,{divider:!0},c.a.createElement(L.a,{component:k.b,to:"/".concat(r),className:t.btn},c.a.createElement(M.a,{primary:"Entities"})),c.a.createElement(f.a,{color:"inherit","aria-label":"Expand ".concat(r," entities"),onClick:function(){return g(!j)},edge:"end",className:Object(O.a)(0===u.length&&t.hide)},j?c.a.createElement(U.a,null):c.a.createElement(z.a,null))),u.length>0?c.a.createElement(G.a,{in:j,timeout:"auto",unmountOnExit:!0},c.a.createElement(P.a,{className:t.root,disablePadding:!0},u.map(function(e){return c.a.createElement(H,{key:e.id,name:e.name,projectName:r})}))):null)))},B=n(196);var V=function(e){var t=Object(b.d)(B.a);return c.a.createElement(P.a,null,c.a.createElement(F.a,{button:!0,component:k.b,to:"/",divider:!0},c.a.createElement(M.a,{primary:"Overview"})),t.map(function(e){return c.a.createElement(Y,{id:e.id,name:e.name,key:e.id})}))},q=Object(u.a)(function(e){return{root:e.sidebar,paper:Object(r.a)({backgroundColor:e.palette.primary.main},e.sidebarPaper),direction:e.direction,btn:Object(r.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar,{justifyContent:"flex-end"})}});var Q=function(e){var t=q(),n=Object(b.c)(),r=Object(b.d)(function(e){return e.sidebar});return c.a.createElement(c.a.Fragment,null,c.a.createElement(s.a,{mdUp:!0},c.a.createElement(N.a,{className:t.root,variant:"temporary",anchor:"rtl"===t.direction?"right":"left",open:r,classes:{paper:t.paper},ModalProps:{keepMounted:!0}},c.a.createElement("div",{className:t.btn},c.a.createElement(f.a,{onClick:function(){return n(Object(g.m)(!r))}},"ltr"===t.direction?c.a.createElement(D.a,null):c.a.createElement(R.a,null))),c.a.createElement(I.a,null),c.a.createElement(V,null))),c.a.createElement(s.a,{smDown:!0},c.a.createElement(N.a,{className:t.root,classes:{paper:t.paper},variant:"permanent",open:!0},c.a.createElement(V,null))))},X=n(197),Z=n(175),$=n(377),ee=n.n($),te=n(280),ne=n(123),re=n(174);var ae=function(e){var t=Object(b.c)();return Object(a.useEffect)(function(){var e=ee()();return e.on("open",function(){var n=e.subscribe("project"),r=e.subscribe("entity"),a=e.subscribe("document"),c=e.subscribe("storage");n.on("add",function(e){console.log("add project"),console.log(e),t(Object(X.a)([{id:e._id,name:e.name,img:e.img_url,created:e.created_at,updated:e.updated_at,publicKey:e.public_key}]))}),n.on("delete",function(e){console.log("delete project"),console.log(e),t(Object(X.b)(e._id))}),n.on("rename",function(e){console.log("rename project"),console.log(e),t(Object(X.e)(e._id,e.name,e.updated_at))}),n.on("img",function(e){console.log("change image of project"),console.log(e),t(Object(X.c)(e._id,e.img_url,e.updated_at))}),n.on("error",function(e){console.log(e)}),r.on("add",function(e){console.log("add entity"),console.log(e),t(Object(te.a)([{id:e._id,projectId:e.project_id,name:e.name,created:e.created_at,updated:e.updated_at,schema:e.schema}]))}),r.on("delete",function(e){console.log("delete entity"),console.log(e),t(Object(te.b)([e._id]))}),r.on("rename",function(e){console.log("rename entity"),console.log(e),t(Object(te.c)(e._id,e.name,e.updated_at))}),r.on("schema",function(e){console.log("set entity schema"),console.log(e),t(Object(te.d)(e._id,e.schema,e.updated_at))}),r.on("error",function(e){console.log(e)}),a.on("add",function(e){console.log("add document"),console.log(e),t(Object(ne.a)([{id:e._id,entityId:e.entity_id,created:e.created_at,updated:e.updated_at,data:e.data}]))}),a.on("modify",function(e){console.log("modify document"),console.log(e),t(Object(ne.g)(e._id,e.updated_at,e.data))}),a.on("delete",function(e){console.log("delete documents"),console.log(e),t(Object(ne.c)(e.ids))}),c.on("upload",function(e){console.log("upload into storage"),console.log(e),t(Object(re.i)(e._id,e.path,e.files))}),c.on("folder",function(e){console.log("new folder into storage"),console.log(e),t(Object(re.d)(e._id,e.path))}),c.on("move",function(e){console.log("move storage"),console.log(e),t(Object(re.g)(e._id,e.path,e.targets))}),c.on("rename",function(e){console.log("rename storage"),console.log(e),t(Object(re.h)(e._id,e.path,e.name,e.new_name))}),c.on("delete",function(e){console.log("delete storage"),console.log(e),t(Object(re.b)(e._id,e.paths))})}),e.on("close",function(){}),e.on("error",function(e){console.log(e)}),e.connect(),function(){e.close()}},[]),null},ce=Object(a.lazy)(function(){return n.e(17).then(n.bind(null,678))}),oe=Object(a.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(16)]).then(n.bind(null,683))}),ie=Object(a.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(15)]).then(n.bind(null,673))}),ue=Object(a.lazy)(function(){return Promise.all([n.e(0),n.e(14),n.e(18)]).then(n.bind(null,674))}),le=Object(a.lazy)(function(){return Promise.all([n.e(0),n.e(1),n.e(19)]).then(n.bind(null,676))}),de=Object(u.a)(function(e){return{root:Object(r.a)({marginTop:65,paddingTop:15,paddingBottom:15,backgroundColor:e.palette.background.light.light,overflow:"auto"},e.responsive)}});t.default=function(e){var t=de(),n=Object(b.c)(),r=Object(b.d)(function(e){return e.authStatus});return Object(a.useEffect)(function(){n(Object(X.d)())},[]),r===_.f?c.a.createElement(o.a,{to:"/signup"}):r===_.g?c.a.createElement(o.a,{to:"/signin"}):c.a.createElement(c.a.Fragment,null,c.a.createElement(x,e),c.a.createElement(Q,null),c.a.createElement(ae,null),c.a.createElement(Z.a,{className:t.root},c.a.createElement(a.Suspense,{fallback:c.a.createElement("div",null)},c.a.createElement(o.d,null,c.a.createElement(o.b,{path:"/:project/:entity/:document",component:ue}),c.a.createElement(o.b,{path:"/:project/authentication",component:null}),c.a.createElement(o.b,{path:"/:project/storage",component:le}),c.a.createElement(o.b,{path:"/:project/:entity",component:ie}),c.a.createElement(o.b,{path:"/:project",component:oe}),c.a.createElement(o.b,{path:"/",component:ce})))),c.a.createElement(C,null))}}}]);
//# sourceMappingURL=7.658b9b74.chunk.js.map