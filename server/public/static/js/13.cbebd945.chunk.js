(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{160:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(170),c=n(167),i=n(695),l=n(696),s=n(697),u=n(698),m=n(397),d=n(353),f=n(235);var p=function(e){var t=e.request,n=e.btn,a=e.category,o=e.values,c=o.name,i=o.newName,l=o.confirmName,s=e.errors,u=e.touched,p=e.handleChange,b=e.isValid,h=e.setFieldTouched,g=function(e,t){t.persist(),p(t),h(e,!0,!1)};return r.a.createElement(f.a,{container:!0,component:"form",spacing:1,onSubmit:function(e){e.preventDefault(),t({name:c,newName:i,confirmName:l})}},"add"===a?r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"name",name:"name",label:"Name",onChange:g.bind(null,"name"),value:c,helperText:u.name?s.name:"",error:u.name&&Boolean(s.name)}):"delete"===a?r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:g.bind(null,"confirmName"),value:l,helperText:u.confirmName?s.confirmName:"",error:u.confirmName&&Boolean(s.confirmName)}):"rename"===a?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"newName",name:"newName",label:"New Name",onChange:g.bind(null,"newName"),value:i,helperText:u.newName?s.newName:"",error:u.newName&&Boolean(s.newName)}),r.a.createElement(f.a,{component:m.a,item:!0,xs:12,id:"confirmName",name:"confirmName",label:"Confirm Name",onChange:g.bind(null,"confirmName"),value:l,helperText:u.confirmName?s.confirmName:"",error:u.confirmName&&Boolean(s.confirmName)})):null,r.a.createElement(f.a,{item:!0,xs:12,component:d.a,type:"submit",disabled:!b,size:"large"},n))},b=c.object({name:c.string().required("enter name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"name too short").max(50,"name too long")}),h=c.object({name:c.string(),confirmName:c.string().required("re-enter name").matches(/^[a-z0-9_]*$/i,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).oneOf([c.ref("name")],"Confirm Name does not match")}),g=c.object({name:c.string(),confirmName:c.string().required("re-enter name").oneOf([c.ref("name")],"Confirm Name does not match"),newName:c.string().required("enter new name").matches(/^[a-zA-Z0-9_]+$/,{message:"input letters, numbers, and underscore only",excludeEmptyString:!0}).min(1,"new name too short").max(50,"new name too long")}),v={name:""},y=function(e){return{name:e,confirmName:""}},j=function(e){return{name:e,confirmName:"",newName:""}};t.a=function(e){var t=e.title,n=e.content,a=e.targetName,c=e.category,m=e.dialogProps;return r.a.createElement(i.a,m,r.a.createElement(l.a,{id:"dialog-title"},t),r.a.createElement(s.a,null,"add"===c||"delete"===c||"rename"===c?r.a.createElement(r.a.Fragment,null,"delete"===c?r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null,n),r.a.createElement(u.a,null,"Please type in the name of the target to confirm")):null,r.a.createElement(o.a,{validationSchema:"add"===c?b:"rename"===c?g:"delete"===c?h:{},initialValues:"add"===c?v:"rename"===c?j(a):"delete"===c?y(a):{},render:function(t){return r.a.createElement(p,Object.assign({},e,t))}})):"notification"===c?r.a.createElement(u.a,null,n):null))}},211:function(e,t,n){"use strict";var a=n(139);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(142)).default)(r.default.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Create");t.default=o},631:function(e,t,n){"use strict";var a=n(139);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(142)).default)(r.default.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload");t.default=o},704:function(e,t,n){"use strict";n.r(t);var a=n(16),r=n.n(a),o=n(26),c=n(0),i=n.n(c),l=n(284),s=n.n(l),u=n(285),m=n.n(u),d=n(288),f=n.n(d),p=n(287),b=n.n(p),h=n(286),g=n.n(h),v=n(289),y=n.n(v),j=n(212),O=n.n(j),k=n(631),E=n.n(k),w=n(211),N=n.n(w),x=n(276),C=n.n(x),P=n(33),$=n(27),R=n(297),S=n(298),z=n(356);function F(e,t){return!t||"object"!==Object(z.a)(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=n(34),M=n.n(L),T=(n(5),n(147));var B=function(e){function t(){return Object(R.a)(this,t),F(this,_(t).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,i.a.Component),Object(S.a)(t,[{key:"componentDidMount",value:function(){this.ref=M.a.findDOMNode(this),Object(T.b)(this.props.rootRef,this.ref)}},{key:"componentDidUpdate",value:function(e){var t=M.a.findDOMNode(this);e.rootRef===this.props.rootRef&&this.ref===t||(e.rootRef!==this.props.rootRef&&Object(T.b)(e.rootRef,null),this.ref=t,Object(T.b)(this.props.rootRef,this.ref))}},{key:"componentWillUnmount",value:function(){this.ref=null,Object(T.b)(this.props.rootRef,null)}},{key:"render",value:function(){return this.props.children}}]),t}(),A=n(363),I=n.n(A);var q=function(e){var t=Object(c.useRef)(null),n=function(e){console.log("drop mtablebody"),console.log(e.dataTransfer.files),e.preventDefault()},a=function(e){console.log("drag start mtablebody"),e.preventDefault()},r=function(e){console.log("drag end mtablebody"),e.preventDefault()},o=function(e){console.log("drag over mtablebody"),e.preventDefault()},l=function(){return console.log("click")};return Object(c.useEffect)(function(){return t.current.addEventListener("drop",n),t.current.addEventListener("dragstart",a),t.current.addEventListener("dragend",r),t.current.addEventListener("dragover",o),t.current.addEventListener("click",l),function(){t.current.removeEventListener("drop",n),t.current.removeEventListener("dragstart",a),t.current.removeEventListener("dragend",r),t.current.removeEventListener("dragover",o),t.current.removeEventListener("click",l)}},[]),i.a.createElement(B,{rootRef:t},i.a.createElement(I.a,e))},U=n(703),V=n(304),J=n(6),Z=n(15),H=n(45),W=n(138),X=n(35),G=n(141),K=n(364),Q=i.a.forwardRef(function(e,t){var n=e.classes,a=e.className,r=e.color,o=void 0===r?"secondary":r,c=e.edge,l=void 0!==c&&c,s=e.size,u=void 0===s?"medium":s,m=Object(Z.a)(e,["classes","className","color","edge","size"]),d=i.a.createElement("span",{className:n.thumb});return i.a.createElement("span",{className:Object(H.a)(n.root,a,{start:n.edgeStart,end:n.edgeEnd}[l],{small:n["size".concat(Object(G.a)(u))]}[u])},i.a.createElement(K.a,Object(J.a)({type:"checkbox",icon:d,checkedIcon:d,classes:{root:Object(H.a)(n.switchBase,n["color".concat(Object(G.a)(o))]),input:n.input,checked:n.checked,disabled:n.disabled},ref:t},m)),i.a.createElement("span",{className:n.track}))}),Y=Object(W.a)(function(e){return{root:{display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle"},edgeStart:{marginLeft:-8},edgeEnd:{marginRight:-8},switchBase:{position:"absolute",top:0,left:0,zIndex:1,color:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[400],transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),willChange:"left, transform","&$checked":{left:"100%",transform:"translateX(-100%)"},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{opacity:.5},"&$disabled + $track":{opacity:"light"===e.palette.type?.12:.1}},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(X.c)(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.primary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(X.c)(e.palette.secondary.main,e.palette.action.hoverOpacity)}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.secondary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},sizeSmall:{width:40,height:24,padding:7,"& $thumb":{width:16,height:16},"& $switchBase":{padding:4}},checked:{},disabled:{},input:{left:"-100%",width:"300%"},thumb:{boxShadow:e.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},track:{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.type?.38:.3}}},{name:"MuiSwitch"})(Q),ee=n(18);var te=function(e){var t=e.rowData,n=Object(P.c)();return i.a.createElement(U.a,{display:"flex",alignItems:"center"},i.a.createElement(Y,{checked:t.isPublic,onChange:function(){var e=Object(o.a)(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.a.post("storage/".concat(t.id,"/public"));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),n(Object(ee.j)("Toggle File Access","Fail toggling file access, error: ".concat(e.t0)));case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(V.a,null,t.isPublic?"Public":"Private"))},ne=n(221),ae=n(222),re=function(e){return e.storage},oe=function(){return Object(ne.a)(re,function(e,t){return Object(ae.b)()(e,t)},function(e,t){return{project:t,storage:Object.values(e).filter(function(e){return e.project_id===t.id})}})},ce=n(160);var ie=function(e){var t=Object(P.c)(),n=Object(P.d)(function(e){return e.target}),a=Object(P.d)(function(e){return e.dialog}),c=Object(P.d)(function(e){return e.notification});return i.a.createElement(i.a.Fragment,null,i.a.createElement(ce.a,{dialogProps:{open:a===ee.f,onClose:function(){return t(Object(ee.c)())}},category:"add",title:'Rename "'.concat(n.name,'"'),btn:"Rename ".concat(n.name),request:function(){var e=Object(o.a)(r.a.mark(function e(a){var o,c,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.name,c=n.name.split(".")[1],i=c?"".concat(o,".").concat(c):o,e.prev=3,e.next=6,$.a.post("storage/".concat(n.id,"/rename"),{name:i});case 6:t(Object(ee.c)()),t(Object(ee.j)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Succeed renaming "'.concat(n.name,'" into "').concat(i,'"'))),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),t(Object(ee.c)()),t(Object(ee.j)('Rename "'.concat(n.name,'" into "').concat(i,'"'),'Fail renaming "'.concat(n.name,'" into "').concat(i,", error: ").concat(e.t0,'"')));case 14:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}()}),i.a.createElement(ce.a,{category:"notification",title:c.title,content:c.content,dialogProps:{open:""!==c.title&&""!==c.content,onClose:function(){return t(Object(ee.d)())}}}))},le=[{field:"id",searchable:!1,hidden:!0},{title:"Name",field:"name",searchable:!0},{title:"Size",field:"size",searchable:!1},{title:"Created At",field:"created",searchable:!1},{title:"Modified At",field:"modified",searchable:!1},{title:"Is Public?",field:"isPublic",render:function(e){return i.a.createElement(te,{rowData:e})}}];t.default=function(e){var t=Object(P.c)(),n=e.match.params.project,a=Object(c.useRef)(null),l=Object(c.useMemo)(oe,[]),u=Object(P.d)(function(e){return l(e,n)});return console.log(u),i.a.createElement(i.a.Fragment,null,i.a.createElement(ie,null),i.a.createElement(C.a,{title:"Storage",columns:le,data:u.storage.map(function(e){return{id:e.id,name:e.name,size:e.size,created:e.created,modified:e.modified,isPublic:e.isPublic}}),actions:[{icon:function(){return i.a.createElement(E.a,null)},tooltip:"Upload Files",isFreeAction:!0,onClick:function(){return a.current.click()}},function(e){return{icon:function(){return i.a.createElement(N.a,null)},tooltip:"Rename",onClick:function(e,n){t(Object(ee.g)({id:n[0].id,name:n[0].name})),t(Object(ee.k)())},hidden:1!==e.length}},{icon:function(){return i.a.createElement(O.a,null)},tooltip:"Delete",onClick:function(){var e=Object(o.a)(r.a.mark(function e(n,a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.a.delete("storage",{data:{ids:a.map(function(e){return e.id})}});case 3:t(Object(ee.j)("Delete Files","Succeed deleting files")),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t(Object(ee.j)("Delete Files","Fail deleting files, error: ".concat(e.t0)));case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,n){return e.apply(this,arguments)}}()}],icons:{Search:s.a,ResetSearch:m.a,FirstPage:g.a,PreviousPage:b.a,NextPage:f.a,LastPage:y.a},components:{Body:q},options:{search:!1,selection:!0,paging:!1,draggable:!1,actionsColumnIndex:-1}}),i.a.createElement("input",{multiple:!0,name:"files",type:"file",style:{display:"none"},ref:a,onChange:function(){var e=Object(o.a)(r.a.mark(function e(n){var o,c,i,l,s,m,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log(a.current.files),e.prev=1,o=new FormData,c=!0,i=!1,l=void 0,e.prev=6,s=a.current.files[Symbol.iterator]();!(c=(m=s.next()).done);c=!0)d=m.value,o.append("file[]",d,d.name);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),i=!0,l=e.t0;case 14:e.prev=14,e.prev=15,c||null==s.return||s.return();case 17:if(e.prev=17,!i){e.next=20;break}throw l;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return e.next=24,$.a.post("storage/".concat(u.project.id),o,{headers:{"Content-Type":"multipart/form-data"}});case 24:t(Object(ee.j)("Upload Files","Succeed uploading files")),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(1),t(Object(ee.j)("Upload Files","Fail uploading files, error: ".concat(e.t1)));case 30:case"end":return e.stop()}},e,null,[[1,27],[6,10,14,22],[15,,17,21]])}));return function(t){return e.apply(this,arguments)}}()}))}}}]);
//# sourceMappingURL=13.cbebd945.chunk.js.map